<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Theory of Electromagnetic Methods – 7&nbsp; Sources in unbounded media</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./timedomain_fullspace.html" rel="next">
<link href="./mtfields.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
window.MathJax = {
  loader: {
    load: ['[tex]/physics']
  },
  tex: {
    packages: {'[+]': ['physics']}
  }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./potentials.html">Dipole induction</a></li><li class="breadcrumb-item"><a href="./potentials.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sources in unbounded media</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Theory of Electromagnetic Methods</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prerequisites</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Electromagnetic fields</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Fourier transform</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Maxwell’s equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maxwell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Maxwell’s Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pde.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Partial Differential Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mtfields.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plane waves above and inside a homogeneous Earth</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Dipole induction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./potentials.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sources in unbounded media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./timedomain_fullspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fields in the time domain</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./halfspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dipole sources above a uniform halfspace</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hankel_transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numerical calculation of the EM Hankel integrals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./layered_halfspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dipole sources above a layered halfspace</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./timedomain_halfspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Dipole induction over a layered halfspace in the time domain</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Summary</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#polarization-vectors" id="toc-polarization-vectors" class="nav-link active" data-scroll-target="#polarization-vectors"><span class="header-section-number">7.1</span> Polarization vectors</a></li>
  <li><a href="#electromagnetic-potentials" id="toc-electromagnetic-potentials" class="nav-link" data-scroll-target="#electromagnetic-potentials"><span class="header-section-number">7.2</span> Electromagnetic potentials</a></li>
  <li><a href="#the-curl-curl-equation-for-the-potentials" id="toc-the-curl-curl-equation-for-the-potentials" class="nav-link" data-scroll-target="#the-curl-curl-equation-for-the-potentials"><span class="header-section-number">7.3</span> The curl-curl equation for the potentials</a></li>
  <li><a href="#the-vector-helmholtz-equations-for-the-potentials" id="toc-the-vector-helmholtz-equations-for-the-potentials" class="nav-link" data-scroll-target="#the-vector-helmholtz-equations-for-the-potentials"><span class="header-section-number">7.4</span> The vector Helmholtz equations for the potentials</a></li>
  <li><a href="#solutions-of-the-inhomogeneous-helmholtz-equation" id="toc-solutions-of-the-inhomogeneous-helmholtz-equation" class="nav-link" data-scroll-target="#solutions-of-the-inhomogeneous-helmholtz-equation"><span class="header-section-number">7.5</span> Solutions of the inhomogeneous Helmholtz equation</a></li>
  <li><a href="#the-greens-function" id="toc-the-greens-function" class="nav-link" data-scroll-target="#the-greens-function"><span class="header-section-number">7.6</span> The Green’s function</a>
  <ul class="collapse">
  <li><a href="#free-space" id="toc-free-space" class="nav-link" data-scroll-target="#free-space"><span class="header-section-number">7.6.1</span> Free space</a></li>
  <li><a href="#quasi-static-approximation" id="toc-quasi-static-approximation" class="nav-link" data-scroll-target="#quasi-static-approximation"><span class="header-section-number">7.6.2</span> Quasi-static approximation</a></li>
  <li><a href="#numerical-experiments-with-the-time-domain-greens-function" id="toc-numerical-experiments-with-the-time-domain-greens-function" class="nav-link" data-scroll-target="#numerical-experiments-with-the-time-domain-greens-function"><span class="header-section-number">7.6.3</span> Numerical experiments with the time-domain Green’s function</a></li>
  </ul></li>
  <li><a href="#the-fields-of-a-dipole-source-in-full-space" id="toc-the-fields-of-a-dipole-source-in-full-space" class="nav-link" data-scroll-target="#the-fields-of-a-dipole-source-in-full-space"><span class="header-section-number">7.7</span> The fields of a dipole source in full-space</a>
  <ul class="collapse">
  <li><a href="#electric-field" id="toc-electric-field" class="nav-link" data-scroll-target="#electric-field"><span class="header-section-number">7.7.1</span> Electric field</a></li>
  <li><a href="#magnetic-field" id="toc-magnetic-field" class="nav-link" data-scroll-target="#magnetic-field"><span class="header-section-number">7.7.2</span> Magnetic field</a></li>
  </ul></li>
  <li><a href="#apparent-resistivity" id="toc-apparent-resistivity" class="nav-link" data-scroll-target="#apparent-resistivity"><span class="header-section-number">7.8</span> Apparent resistivity</a>
  <ul class="collapse">
  <li><a href="#instrument-error" id="toc-instrument-error" class="nav-link" data-scroll-target="#instrument-error"><span class="header-section-number">7.8.1</span> Instrument error</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./potentials.html">Dipole induction</a></li><li class="breadcrumb-item"><a href="./potentials.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sources in unbounded media</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sources in unbounded media</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter, we will consider finite sources in unbounded media. In geo-electromagnetic applications, magnetic dipoles, electric dipoles, long grounded cables, and large loops are used as sources.</p>
<p>However, until now, we have studied induction in a source-free, uniform region, where we have coupled the source current contribution by boundary conditions, such as an inducing uniform, plane wave magnetic field in the Air halfspace.</p>
<p>We will address the following topics:</p>
<ul>
<li>Polarization vectors</li>
<li>Potentials</li>
<li>Gauge conditions</li>
<li>Green’s function of the uniform full-space</li>
<li>Electric and magnetic dipole sources in full-space.</li>
</ul>
<section id="polarization-vectors" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="polarization-vectors"><span class="header-section-number">7.1</span> Polarization vectors</h2>
<p>In the absence of matter, we observe that</p>
<p><span class="math display">\[
\mathbf d - \varepsilon_0 \mathbf e = \mathbf 0
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mu_0^{-1} \mathbf b - \mathbf h = \mathbf 0.
\]</span></p>
<p>When the differences are non-zero, then we observe the response of matter. We define the <em>electrical polarization</em> <span class="math inline">\(\mathbf p\)</span> <span class="math display">\[
\mathbf p = \mathbf d - \varepsilon_0 \mathbf e
\]</span></p>
<p>and the magnetic polarization or magnetization <span class="math inline">\(\mathbf m\)</span></p>
<p><span class="math display">\[
\mathbf m = \mu_0^{-1} \mathbf b - \mathbf h
\]</span></p>
<p>The polarization vectors <span class="math inline">\(\mathbf p\)</span> and <span class="math inline">\(\mathbf m\)</span> are parallel and proportional to <span class="math inline">\(\mathbf e\)</span> and <span class="math inline">\(\mathbf h\)</span>, resp.</p>
<p>We are able to quantify the polarization properties by the electrical susceptibility <span class="math inline">\(\chi_e\)</span> and magnetic susceptibility <span class="math inline">\(\chi_m\)</span>. The latter is often referred to as the magnetic susceptibility <span class="math inline">\(\kappa\)</span>.</p>
<p>We define</p>
<p><span class="math display">\[
\mathbf p := \chi_e \varepsilon_0 \mathbf e = \mathbf d - \varepsilon_0 \mathbf e
\]</span></p>
<p>and likewise</p>
<p><span class="math display">\[
\mathbf m := \chi_m \mathbf h = \mu_0^{-1} \mathbf b - \mathbf h.
\]</span></p>
<p>It follows for the relative dielectric permittivity</p>
<p><span class="math display">\[
\varepsilon_r = 1 + \chi_e
\]</span></p>
<p>and for the relative magnetic permeability</p>
<p><span class="math display">\[
\mu_r = 1 + \chi_m = 1 + \kappa.
\]</span></p>
<p>To implement technical sources, we separate the polarization into induced (superscript <span class="math inline">\(i\)</span>) and external (superscript <span class="math inline">\(s\)</span>) contributions to the observed fields:</p>
<p><span class="math display">\[
\mathbf p = \mathbf p^i + \mathbf p^s = \mathbf d - \varepsilon_0 \mathbf e.
\]</span></p>
<p>Then,</p>
<p><span class="math display">\[
\mathbf d = [\underbrace{\varepsilon_0 \mathbf e}_\text{free space} + \underbrace{\mathbf p^i}_\text{matter}] + \mathbf p^s
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mathbf b = [\underbrace{\mu_0 \mathbf h}_\text{free space} + \underbrace{\mu_0 \mathbf m^i}_\text{matter}] + \mu_0 \mathbf m^s
\]</span></p>
<p>With the introduction of the polarization vectors, we are now able to augment Maxwell’s equations, such that</p>
<p><span class="math display">\[
\begin{align}
\curl \mathbf h &amp; = \mathbf j + \varepsilon \partial_t \mathbf e + \partial_t \mathbf p^s \\
\curl \mathbf e &amp; = \phantom{\mathbf j} -\mu \partial_t \mathbf h - \mu_0 \partial_t \mathbf m^s
\end{align}
\]</span></p>
<p>We define the <em>source current densities</em> in the magnetic and electric case as</p>
<p><span class="math display">\[
\mathbf j_m^s := \mu_0 \partial_t \mathbf m^s
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mathbf j_e^s := \phantom{\mu_0} \partial_t \mathbf p^s .
\]</span></p>
<p>Now, we extend our definitions to the frequency domain:</p>
<p><span class="math display">\[
\mathbf J_m^s := i \omega \mu_0 \mathbf M^s
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mathbf J_e^s := i \omega \mathbf P^s .
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Example">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>We consider a magnetic dipole at the point <span class="math inline">\(\mathbf r_0 = [0, 0, -h]^\top, h &gt; 0\)</span>.</p>
<p>The point of observation is at <span class="math inline">\(\mathbf r = [x, y, z]^\top\)</span>.</p>
<p>The location of the dipole can now be pinned to <span class="math inline">\(\mathbf r_0\)</span> using a Dirac delta function.</p>
<p>We obtain</p>
<p><span class="math display">\[
\mathbf M^s(\mathbf r) = \mathbf m \, \delta(\mathbf r - \mathbf r_0)
\]</span></p>
<p>with <span class="math inline">\(\mathbf m\)</span> the oriented <em>magnetic dipole moment</em>. The dipole moment has the physical dimension of <span class="math inline">\([\mathbf m] =\)</span> A<span class="math inline">\(\cdot m^2\)</span>. It can be interpreted as a current <span class="math inline">\(I\)</span> measured in A enclosing a surface measured in <span class="math inline">\(m^2\)</span>.</p>
<p>As a vector quantity, the dipole moment has a direction. Its direction is given by the unit vector normal to the surface of the enclosed area.</p>
<p>A useful special case arises when the dipole is aligned with one of the Cartesian axes.</p>
<p>This way, we can define a vertical or horizontal dipole.</p>
</div>
</div>
</section>
<section id="electromagnetic-potentials" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="electromagnetic-potentials"><span class="header-section-number">7.2</span> Electromagnetic potentials</h2>
<p>Let’s assume that electric and magnetic fields originate from <em>either</em> a magnetic or an electric source, i.e.,</p>
<p><span class="math display">\[
\begin{align}
\mathbf E &amp; = \mathbf E_m + \mathbf E_e \\
\mathbf H &amp; = \mathbf H_m + \mathbf H_e
\end{align}
\]</span></p>
<p>When <span class="math inline">\(\mathbf J_e \equiv 0\)</span>, then we only observe the set of fields <span class="math inline">\([\mathbf E_m, \mathbf H_m]\)</span>.</p>
<p>When <span class="math inline">\(\mathbf J_m \equiv 0\)</span>, then we only observe the set of fields <span class="math inline">\([\mathbf E_e, \mathbf H_e]\)</span>.</p>
<p>The two sets are disjoint. We insert into Maxwell’s equations</p>
<p><span class="math display">\[
\begin{align}
\curl \mathbf E_m &amp; = -i \omega \mu \mathbf H_m \textcolor{red}{- \mathbf J_m^s} \\
\curl \mathbf H_m &amp; = (\sigma + i \omega \varepsilon) \mathbf E_m
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\curl \mathbf E_e &amp; = -i \omega \mu \mathbf H_e  \\
\curl \mathbf H_e &amp; = (\sigma + i \omega \varepsilon) \mathbf E_e \textcolor{red}{+ \mathbf J_e^s}
\end{align}
\]</span></p>
<p>Now we apply the divergence to all of the above equations. Here we employ the identity</p>
<p><span id="eq-divrot"><span class="math display">\[
\divergence (\curl \mathbf F) = 0,
\tag{7.1}\]</span></span></p>
<p>such that, e.g.,</p>
<p><span class="math display">\[
\underbrace{\divergence (\curl \mathbf E_m)}_{=0}  = -i \omega \mu \divergence \mathbf H_m - \divergence \mathbf J_m^s.
\]</span></p>
<p>We obtain</p>
<p><span class="math display">\[
\begin{align}
\divergence \mathbf H_m &amp; = -\frac{ \divergence \mathbf J_m^s }{i \omega \mu } \\
\divergence \mathbf E_e &amp; = -\frac{ \divergence \mathbf J_e^s }{\sigma + i \omega \varepsilon } \\
\divergence \mathbf H_e &amp; = 0 \\
\divergence \mathbf E_m &amp; = 0.
\end{align}
\]</span></p>
<p>Since the divergence of <span class="math inline">\(\mathbf H_e\)</span> and <span class="math inline">\(\mathbf E_m\)</span> are zero, we can express both fields by the curl of an arbitrary vector field according to <a href="#eq-divrot" class="quarto-xref"><span>7.1</span></a>. However, this vector field must fulfill Maxwell’s equations. The following ansatz employing the vector potentials <span class="math inline">\(\mathbf F\)</span> and <span class="math inline">\(\mathbf A\)</span> meets this requirement:</p>
<p><span class="math display">\[
\begin{align}
\mathbf E_m &amp; = -\curl \mathbf F \\
\mathbf H_e &amp; = \phantom{-} \curl \mathbf A.
\end{align}
\]</span></p>
<p>It follows</p>
<p><span class="math display">\[
\begin{align}
\curl \mathbf H_m &amp; = -(\sigma + i \omega \varepsilon) \curl \mathbf F \\
\curl \mathbf E_e &amp; = -i \omega \mu \curl \mathbf A
\end{align}
\]</span></p>
<p>from which we obtain</p>
<p><span class="math display">\[
\begin{align}
\mathbf H_m &amp; = -(\sigma + i \omega \varepsilon) \mathbf F - \grad V \\
\mathbf E_e &amp; = -i \omega \mu \mathbf A - \grad U
\end{align}
\]</span></p>
<p>because</p>
<p><span class="math display">\[
\curl \nabla u = \mathbf 0
\]</span></p>
<p>for any scalar function <span class="math inline">\(u: \mathbb R^3 \mapsto \mathbb R\)</span>.</p>
<p>The scalar potentials <span class="math inline">\(V\)</span> and <span class="math inline">\(U\)</span> are referred to as magnetic and electrical scalar potential, resp.</p>
</section>
<section id="the-curl-curl-equation-for-the-potentials" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="the-curl-curl-equation-for-the-potentials"><span class="header-section-number">7.3</span> The curl-curl equation for the potentials</h2>
<p>Let’s insert the potentials into Maxwell’s equations.</p>
<p><span class="math display">\[
\begin{align}
\mathbf E_m &amp; = - \curl \mathbf F \\
\curl \mathbf E_m &amp; = - \curl \curl \mathbf F &amp;&amp; = -i \omega \mu \textcolor{red}{\mathbf H_m} - \mathbf J^s_m \\
&amp;   &amp;&amp; = i \omega \mu \textcolor{red}{(\sigma + i \omega \varepsilon) \mathbf F} + i \omega \mu \textcolor{red}{\grad V} - \mathbf J^s_m
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\mathbf H_e &amp; = \phantom{-} \curl \mathbf A \\
\curl \mathbf H_e &amp; = \phantom{-} \curl \curl \mathbf A &amp;&amp; = (\sigma + i \omega \varepsilon) \textcolor{red}{\mathbf E_e} + \mathbf J^s_e \\
&amp;   &amp;&amp; = \textcolor{red}{-i \omega \mu} (\sigma + i \omega \varepsilon) \textcolor{red}{\mathbf A} - i \omega \mu \textcolor{red}{\grad U} + \mathbf J^s_e
\end{align}
\]</span></p>
<p>We use the vector identity <a href="pde.html#eq-vector-identity" class="quarto-xref"><span>5.2</span></a> and obtain</p>
<p><span class="math display">\[
\begin{align}
-\laplacian \mathbf F + \nabla \divergence \mathbf F + i \omega \mu (\sigma + i \omega \varepsilon) \mathbf F + i \omega \mu \grad V &amp; = + \mathbf J^s_m \\
-\laplacian \mathbf A + \nabla \divergence \mathbf A + i \omega \mu (\sigma + i \omega \varepsilon) \mathbf A + i \omega \mu \grad U &amp; = + \mathbf J^s_e
\end{align}
\]</span></p>
</section>
<section id="the-vector-helmholtz-equations-for-the-potentials" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="the-vector-helmholtz-equations-for-the-potentials"><span class="header-section-number">7.4</span> The vector Helmholtz equations for the potentials</h2>
<p>Question: How to get rid of <span class="math inline">\(V\)</span> and <span class="math inline">\(U\)</span>?</p>
<p>We choose the arbitrary scalar potential <span class="math inline">\(V, U\)</span> such that it cancels with the expression <span class="math inline">\(\divergence \mathbf F\)</span> and <span class="math inline">\(\divergence \mathbf A\)</span>, resp.</p>
<p><span class="math display">\[
\begin{align}
\grad \divergence \mathbf F &amp; = - i \omega \mu \grad V \\
\divergence \mathbf F &amp; = - i \omega \mu V
\end{align}
\]</span></p>
<p>and obtain</p>
<p><span class="math display">\[
-\laplacian \mathbf F + i \omega \mu (\sigma + i \omega \varepsilon) \mathbf F = + \mathbf J^s_m.
\]</span> or short <span class="math display">\[
\laplacian \mathbf F + k^2 \mathbf F = -\mathbf J^s_m, \qquad k^2 = -i \omega \mu (\sigma + i \omega \varepsilon).
\]</span></p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Self study">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Self study
</div>
</div>
<div class="callout-body-container callout-body">
<p>Repeat the steps above for the case of <span class="math inline">\(\mathbf A\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Summary">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have eliminated the scalar potentials <span class="math inline">\(V\)</span> and <span class="math inline">\(U\)</span> by use of the <em>Lorenz gauge</em>.</p>
<p>The vector potentials are solutions to</p>
<p><span id="eq-inhomogeneous-helmholtz-F"><span class="math display">\[
\laplacian \mathbf F + k^2 \mathbf F  = -\mathbf J^s_m
\tag{7.2}\]</span></span></p>
<p>and</p>
<p><span id="eq-inhomogeneous-helmholtz-A"><span class="math display">\[
\laplacian \mathbf A + k^2 \mathbf A = -\mathbf J^s_e.
\tag{7.3}\]</span></span></p>
<p>These equations are called <em>inhomogeneous Helmholtz equations</em>.</p>
<p>Note that the vector potentials are <em>aligned</em> with the direction of the source current densities!</p>
</div>
</div>
</section>
<section id="solutions-of-the-inhomogeneous-helmholtz-equation" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="solutions-of-the-inhomogeneous-helmholtz-equation"><span class="header-section-number">7.5</span> Solutions of the inhomogeneous Helmholtz equation</h2>
<p>We now want to find solutions to the inhomogeneous vector Helmholtz equations.</p>
<p>Let’s consider the potential <span class="math inline">\(\mathbf A\)</span> as defined in <a href="#eq-inhomogeneous-helmholtz-A" class="quarto-xref"><span>7.3</span></a>.</p>
<p>To obtain a solution, we take the following steps:</p>
<ol type="1">
<li>transform the expressions into the Fourier wave number domain</li>
<li>solve the algebraic equation</li>
<li>transform back into space domain</li>
</ol>
<p>First, we need a useful definition of the Fourier transform. We follow a similar notation like that given in <a href="fourier.html#eq-fourier" class="quarto-xref"><span>3.2</span></a>, but instead of time and angular frequency we choose as variables the Cartesian coordinates <span class="math inline">\(x, y, z\)</span> and the corresponding wave numbers <span class="math inline">\(k_x, k_y, k_z\)</span>.</p>
<p>We define the <em>3-D Fourier transform pair</em></p>
<p><span class="math display">\[
\begin{align}
\tilde{\mathbf A}(k_x, k_y, k_z)
    &amp; = \iiint\limits_{-\infty}^\infty \mathbf A(x,y,z) e^{-i(k_x x + k_y y + k_z z)}\, \mathrm d x \mathrm d y \mathrm d z \\
\mathbf A(x,y,z)  &amp; = \frac{ 1 }{(2 \pi)^3 } \iiint\limits_{-\infty}^\infty \tilde{\mathbf A}(k_x, k_y, k_z) e^{+i(k_x x + k_y y + k_z z)} \, \mathrm d k_x \mathrm d k_y \mathrm d k_z
\end{align}
\]</span></p>
<p>Also required are the differentiation, convolution, and linearity properties of the Fourier transform.</p>
<p>We recognize that in a Cartesian coordinate system</p>
<p><span class="math display">\[
\laplacian := \partial^2_{xx} + \partial^2_{yy} + \partial^2_{zz}
\]</span></p>
<p>and therefore</p>
<p><span class="math display">\[
\partial^2_{xx} e^{-i k_x x} = -k_x^2 e^{-i k_x x} \text{ etc.}
\]</span></p>
<p>After transformation of <a href="#eq-inhomogeneous-helmholtz-F" class="quarto-xref"><span>7.2</span></a> into the wave number domain, we have</p>
<p><span class="math display">\[
(-k_x^2 - k_y^2 - k_z^2 + k^2) \tilde{\mathbf A} = -\tilde{\mathbf J}^s_m.
\]</span></p>
<p>Recall that <span class="math inline">\(k^2 = -i \omega \mu (\sigma + i \omega \varepsilon)\)</span>.</p>
<p>After rearranging we obtain</p>
<p><span id="eq-AGJ"><span class="math display">\[
\tilde{\mathbf A} = \tilde{\tilde{G}} \tilde{\mathbf J}^s_m
\tag{7.4}\]</span></span></p>
<p>with the scalar function</p>
<p><span class="math display">\[
\tilde{\tilde{G}} = (k_x^2 + k_y^2 + k_z^2 - k^2)^{-1}.
\]</span></p>
<p><span class="math inline">\(\tilde{\tilde{G}}\)</span> is the 3-D Fourier transform of what we will later refer to as <em>Green’s function</em>.</p>
<p>We can obtain <span class="math inline">\(\mathbf A\)</span> directly in the spatial domain by evaluating a 3-D convolution integral, since <a href="#eq-AGJ" class="quarto-xref"><span>7.4</span></a> is a multiplication in the wave number domain by exploiting the convolution property of the Fourier transform. Unfortunately, we still have not found an expression for <span class="math inline">\(G\)</span>.</p>
<p>To this end, let’s consider a PDE similar to <a href="#eq-inhomogeneous-helmholtz-A" class="quarto-xref"><span>7.3</span></a>. The differences are important: First, the solution to the PDE is a scalar function <span class="math inline">\(G\)</span>, second, the right-hand side of the equation is a Dirac impulse in space.</p>
<p>We depart from</p>
<p><span id="eq-pde-G"><span class="math display">\[
\laplacian G + k^2 G = -\delta(x) \delta(y) \delta(z)
\tag{7.5}\]</span></span></p>
<p>We take steps 1 and 2 as outlined above and obtain</p>
<p><span class="math display">\[
\tilde{\tilde{G}} = (k_x^2 + k_y^2 + k_z^2 - k^2)^{-1}.
\]</span></p>
<p>To find <span class="math inline">\(G\)</span>, we first transform back into space domain w.r.t. <span class="math inline">\(z\)</span> and obtain</p>
<p><span class="math display">\[
\tilde{G}(k_x, k_y, z) = \frac{ 1 }{ 2 \pi} \int\limits_{-\infty}^{\infty}
\tilde{\tilde{G}} e^{i k_z z} \, \mathrm d k_z = \frac{ e^{-u|z|} }{ 2 u}
\]</span></p>
<p>with <span class="math inline">\(u = \sqrt{k_x^2 + k_y^2 - k^2}\)</span>.</p>
<p>Next, we carry out a 2-D Fourier transform w.r.t. <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[
G(x,y,z) = \frac{ 1 }{ 4 \pi^2} \iint\limits_{-\infty}^{\infty} \frac{ e^{-u|z|} }{ 2 u}
e^{i (k_x x + k_y y)} \, \mathrm d k_x  \mathrm d k_y
\]</span></p>
<p>Since <span class="math inline">\(u\)</span> is an axisymmetric function of <span class="math inline">\(k_x\)</span> and <span class="math inline">\(k_y\)</span>, we use of the following <em>Hankel transform</em>:</p>
<p><span class="math display">\[
\frac{ 1 }{ 4 \pi^2} \iint\limits_{-\infty}^{\infty} F(k_x^2 + k_y^2)
e^{i (k_x x + k_y y)} \, \mathrm d k_x  \mathrm d k_y
=
2 \pi \int\limits_0^\infty F(\lambda) J_0(\lambda R) \lambda \, \mathrm d \lambda,
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\lambda^2 = k_x^2 + k_y^2
\]</span></p>
<p>the horizontal wave number,</p>
<p><span class="math display">\[
R^2 = x^2 + y^2
\]</span></p>
<p>the radial distance from the <span class="math inline">\(z\)</span>-axis, and</p>
<p><span class="math display">\[
F :=   \frac{ e^{-u|z|} }{ 2 u}, \quad u^2 = \lambda^2 - k^2.
\]</span></p>
<p>Finally, we obtain the integral</p>
<p><span class="math display">\[
G(R, z) = \frac{ 1 }{ 4 \pi } \int\limits_0^\infty \frac{ \lambda  }{ u} e^{-u|z|} J_0(\lambda R) \, \mathrm d \lambda
\]</span></p>
<p>This is the <em>Sommerfeld integral</em>, from which we get with <span class="math inline">\(r^2 = R^2 + z^2\)</span> the function</p>
<p><span class="math display">\[
G(r) = \frac{ 1 }{ 4 \pi r} e^{- i k r}.
\]</span></p>
<p>This is the <em>Green’s function for the uniform conductive fullspace in the frequenccy domain</em>.</p>
</section>
<section id="the-greens-function" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="the-greens-function"><span class="header-section-number">7.6</span> The Green’s function</h2>
<p>The Green’s function or the <em>impulse response</em> of the conductive fullspace in the frequency domain is</p>
<p><span class="math display">\[
G(r, \omega) = \frac{1}{4 \pi r} e^{- i k r} = \frac{1}{4 \pi r} e^{- i r \sqrt{\omega^2 \mu \varepsilon - i \omega \mu \sigma}}.
\]</span></p>
<p>To obtain the time-domain response <span class="math inline">\(g(r,t)\)</span>, we apply the inverse Fourier transform, i.e.,</p>
<p><span class="math display">\[
g(r, t) = \frac{1}{2 \pi} \frac{1}{4 \pi r} \int\limits_{-\infty}^\infty
e^{- i r \sqrt{\omega^2 \mu \varepsilon - i \omega \mu \sigma}}
e^{i \omega t}
\mathrm{d}\omega.
\]</span></p>
<section id="free-space" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="free-space"><span class="header-section-number">7.6.1</span> Free space</h3>
<p>First, let’s restrict to the free space case, where <span class="math inline">\(\sigma=0\)</span>. We obtain</p>
<p><span class="math display">\[
g(r,t) = \frac{1}{8 \pi^2 r} \int \limits_{-\infty}^\infty
e^{i \omega (t \pm r \sqrt{\mu \varepsilon}) } \mathrm{d}\omega.
\]</span></p>
<p>To obtain <span class="math inline">\(g\)</span>, we need the <em>shifting property</em> of the Fourier transform:</p>
<p><span class="math display">\[
\delta(t \pm t') =  \frac{1}{2 \pi} \int \limits_{-\infty}^\infty
e^{i \omega (t \pm t')}
\mathrm{d}\omega
\]</span></p>
<p>It follows that</p>
<p><span class="math display">\[
g(r, t) = \frac{1 }{4 \pi r}  \delta(t - r / c)
\]</span></p>
<p>The sign is chosen such that causality is guaranteed, i.e.,</p>
<p><span class="math display">\[
g(r, t) = 0 \text{ for } t &lt; 0.
\]</span></p>
<p>The result obtained above is called the <em>retarded potential</em>.</p>
</section>
<section id="quasi-static-approximation" class="level3" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="quasi-static-approximation"><span class="header-section-number">7.6.2</span> Quasi-static approximation</h3>
<p>For moderate to high conductivities and/or low frequencies, we have introduced the <em>quasi-static approximation</em>, which justifies that displacement currents may safely be neglected in geo-electromagnetic applications.</p>
<p>We start from the Green’s function under quasi-static approximation:</p>
<p><span class="math display">\[
G(r, \omega) = \frac{1}{4 \pi r} e^{-i r \sqrt{-i \omega \mu \sigma}} =
\frac{1}{4 \pi r} e^{-r \sqrt{i \omega \mu \sigma}}
\]</span></p>
<p>To obtain the time-domain Green’s function, we apply the Laplace transform, which is as an integral transform similar to the Fourier transform, except that the former is restricted to transformations of functions of <span class="math inline">\(t\)</span> with <span class="math inline">\(t \ge 0\)</span>. This is in accordance to the causality requirement stated above.</p>
<p>With the Laplace variable <span class="math inline">\(s := i \omega\)</span> we rewrite</p>
<p><span class="math display">\[
G(r, s) = \frac{1}{4 \pi r} e^{-r \sqrt{s \mu \sigma}}
\]</span></p>
<p>From <span class="citation" data-cites="Abramowitz1972">Abramowitz &amp; Stegun (<a href="references.html#ref-Abramowitz1972" role="doc-biblioref">1972</a>)</span> we obtain</p>
<p><span class="math display">\[
g(r, t) = \frac{(\mu \sigma)^{1/2}}{(2 \pi t)^{3/2}}
e^{- \frac{\mu\sigma r^2}{4 t}} \, u(t)
\]</span></p>
<p><span class="math inline">\(u(t)\)</span> is the Heaviside step function</p>
<p><span class="math display">\[
    u(t) = \begin{cases} 0 &amp; t &lt; 0 \\ 1 &amp; t &gt; 0. \end{cases}
\]</span></p>
</section>
<section id="numerical-experiments-with-the-time-domain-greens-function" class="level3" data-number="7.6.3">
<h3 data-number="7.6.3" class="anchored" data-anchor-id="numerical-experiments-with-the-time-domain-greens-function"><span class="header-section-number">7.6.3</span> Numerical experiments with the time-domain Green’s function</h3>
<p>We implement the Green’s function in <code>Python</code> and plot it as a function of time or source-receiver-offset, resp.</p>
<p>At first, let’s calculate the Green’s function at a fixed distance of <span class="math inline">\(r=100\)</span> m for a time range of <span class="math inline">\(t \in [10^{-6}, 10^{-2}]\)</span> seconds.</p>
<p>The late time asymptotic <span class="math inline">\(g(r,t) \sim t^{-3/2}\)</span> as <span class="math inline">\(t \to \infty\)</span> is indicated as a straight line in the log-log plot.</p>
<div id="d505e7df" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> green(sigma, r, t):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> np.pi <span class="op">*</span> <span class="fl">4e-7</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> np.sqrt(mu <span class="op">*</span> sigma) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> t)<span class="op">**</span><span class="fl">1.5</span> <span class="op">*</span> <span class="op">\</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        np.exp(<span class="op">-</span><span class="fl">0.25</span> <span class="op">*</span> mu <span class="op">*</span> sigma <span class="op">*</span> r<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> t)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> np.logspace(start<span class="op">=</span><span class="dv">0</span>, stop<span class="op">=</span><span class="dv">4</span>, num<span class="op">=</span><span class="dv">41</span>, endpoint<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.logspace(start<span class="op">=-</span><span class="dv">6</span>, stop<span class="op">=-</span><span class="dv">2</span>, num<span class="op">=</span><span class="dv">41</span>, endpoint<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>rfix <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>tfix <span class="op">=</span> <span class="fl">1e-6</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>g_t <span class="op">=</span> [green(sigma, rfix, tt) <span class="cf">for</span> tt <span class="kw">in</span> t]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>g_r <span class="op">=</span> [green(sigma, rr, tfix) <span class="cf">for</span> rr <span class="kw">in</span> r]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">4</span>), layout<span class="op">=</span><span class="st">'constrained'</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>ax.loglog(t, g_t, label<span class="op">=</span><span class="vs">r'$g(r,t)$'</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>ax.loglog(t, <span class="fl">1e-6</span> <span class="op">*</span> t<span class="op">**</span>(<span class="op">-</span><span class="fl">1.5</span>), label<span class="op">=</span><span class="vs">r'$t^{-3/2}$'</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="fl">1e-4</span>, <span class="fl">1e2</span>))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'t in s'</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$g(r,t)$'</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"r = "</span> <span class="op">+</span> <span class="bu">str</span>(rfix) <span class="op">+</span> <span class="st">" m"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>ax.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="potentials_files/figure-html/cell-2-output-1.png" width="395" height="395" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The following animation shows the interplay between the spatial decay of the Green’s function with time on the left, and the evolution of the Green’s function evaluated at a fixed point in space on the left.</p>
<p>Note the red dots and the red horizontal lines which links both subfigures to each other.</p>
<p><img src="green_animation.gif" class="img-fluid"></p>
</section>
</section>
<section id="the-fields-of-a-dipole-source-in-full-space" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="the-fields-of-a-dipole-source-in-full-space"><span class="header-section-number">7.7</span> The fields of a dipole source in full-space</h2>
<p>If we compare <a href="#eq-pde-G" class="quarto-xref"><span>7.5</span></a> and <a href="#eq-inhomogeneous-helmholtz-F" class="quarto-xref"><span>7.2</span></a>, we recognize the similarity of both PDEs. More specifically, if we would be able to orientate <span class="math inline">\(\mathbf J\)</span> in such a way that it would be aligned to one of the Cartesian axis, then</p>
<p><span class="math display">\[
\mathbf J_m^s(\mathbf r) = i \omega \mu \mathbf m \delta^3(\mathbf r)
\]</span></p>
<p>would simplify for a vertically aligned dipole to</p>
<p><span class="math display">\[
\mathbf J_m^s(\mathbf r) = i \omega \mu \begin{bmatrix}
0 \\ 0 \\ m
\end{bmatrix} \delta^3(\mathbf r) =
\begin{bmatrix}
0 \\ 0 \\ J_m^s
\end{bmatrix}
\]</span></p>
<p>The vector-valued PDE <a href="#eq-inhomogeneous-helmholtz-F" class="quarto-xref"><span>7.2</span></a> would turn into</p>
<p><span class="math display">\[
\laplacian \mathbf F + k^2 \mathbf F = -i \omega \mu m \delta^3(\mathbf r) \mathbf e_z,
\]</span></p>
<p>hence, the scalar potential for a magnetic dipole aligned with the <span class="math inline">\(z\)</span>-axis is</p>
<p><span class="math display">\[
F_z = \mathbf F \cdot \mathbf e_z = \frac{ i \omega \mu m }{ 4 \pi r } e^{-i k r}.
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The potential of a dipole embedded in a uniform fullspace can be calculated with the help of the Green’s function.</p>
<p>Dipole induction problems become particularly easy to solve when the dipole axis is aligned with a Cartesian axis.</p>
</div>
</div>
<p>With the ansatz defined above</p>
<p><span class="math display">\[
\mathbf E_m = - \curl \mathbf F
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mathbf H_m = \frac{ 1 }{ i \omega \mu } (\grad \divergence \mathbf F + k^2 \mathbf F)
\]</span></p>
<p>we can calculate the components of the electric and magnetic fields in a straightforward manner.</p>
<p>Note that there are just spatial derivatives involved.</p>
<p>However, the symmetry of the problem suggests using cylindrical coordinates.</p>
<p><span id="eq-rot-cylindrical"><span class="math display">\[
\begin{align}
    \curl \mathbf F = &amp; \left(
        \frac{1}{r}
    \frac{\partial F_z}{\partial \varphi}-
    \frac{\partial F_\varphi}{\partial z}
    \right){\mathbf e_r} + \\
    &amp; \left(\frac{\partial F_r}{\partial z}-
    \frac{\partial F_z}{\partial r}
    \right) {\mathbf e_\varphi} + \\
    &amp; \frac{1}{r} \left(
        \frac{\partial \left(r F_\varphi\right)}{\partial r}-
    \frac{\partial F_r}{\partial \varphi}
    \right){\mathbf e_z}.
\end{align}
\tag{7.6}\]</span></span></p>
<p>In the case of a dipole oriented in <span class="math inline">\(z\)</span>-direction, the curl simplifies to</p>
<p><span id="eq-rot-F"><span class="math display">\[
\curl \mathbf F = - \frac{\partial F_z}{\partial r} \mathbf e_\varphi,
\tag{7.7}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf e_\varphi\)</span> is the unit coordinate vector in <span class="math inline">\(\varphi\)</span>-direction.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since the dipole axis is aligned with the <span class="math inline">\(z\)</span>-axis, we expect axisymmetric field components.</p>
<p>The magnetic field forms closed field lines which are uniform in the azimuthal <span class="math inline">\(\varphi\)</span>-direction.</p>
<p>For a magnetic dipole aligned with the <span class="math inline">\(z\)</span>-direction we observe the field components</p>
<p><span class="math display">\[
E_\varphi,\quad H_r,\quad H_z.
\]</span></p>
<p>The components are mutual orthogonal!</p>
</div>
</div>
<section id="electric-field" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="electric-field"><span class="header-section-number">7.7.1</span> Electric field</h3>
<p>With the definition</p>
<p><span class="math display">\[
\mathbf E = -\curl \mathbf F
\]</span></p>
<p>we find using <a href="#eq-rot-F" class="quarto-xref"><span>7.7</span></a> that</p>
<p><span class="math display">\[
E_\varphi = \frac{\partial F_z}{\partial r}.
\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[
E_\varphi = \partial_r F_z = -\frac{i \omega \mu m }{4 \pi r^2} (1 + i k r) \exp(-i k r).
\]</span></p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Self study">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Self study
</div>
</div>
<div class="callout-body-container callout-body">
<p>Carry out the derivation by yourself.</p>
</div>
</div>
<p>The change of the basis from cylindrical to Cartesian coordinates requires for the horizontal components</p>
<p><span class="math display">\[
\mathbf E = E_\varphi \mathbf e_\varphi = E_\varphi
\begin{pmatrix}
-\sin\varphi \\
\cos\varphi
\end{pmatrix},
\]</span></p>
<p>since</p>
<p><span class="math display">\[
\begin{bmatrix}
\mathbf e_r \\ \mathbf e_\varphi \\ \mathbf e_z
\end{bmatrix}
=
\begin{bmatrix}
\cos\varphi &amp; \sin\varphi &amp; 0 \\
-\sin\varphi &amp; \cos\varphi &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\mathbf e_x \\ \mathbf e_y \\ \mathbf e_z
\end{bmatrix}.
\]</span></p>
<p>With the angle <span class="math inline">\(\varphi\)</span> counting positive from the <span class="math inline">\(x\)</span>-axis in the direction of <span class="math inline">\(y\)</span>, we can use the relations</p>
<p><span class="math display">\[
\cos\varphi = \frac{x}{r}, \quad \sin\varphi = \frac{y}{r}.
\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[
\begin{align}
E_x &amp; = +i \omega \mu m \frac{\sin\varphi}{4 \pi r^2}(1 + i k r) \exp(-i k r) \\
E_y &amp; = -i \omega \mu m \frac{\cos\varphi}{4 \pi r^2}(1 + i k r) \exp(-i k r)
\end{align}
\]</span></p>
<p>A useful expression for an arbitrary orientation of the dipole is given by</p>
<p><span class="math display">\[
\mathbf E(\mathbf r) = -\frac{i \omega \mu}{4 \pi r^3} (1 + i k r) \exp(-i k r) \mathbf m \times \mathbf r,
\]</span></p>
<p>where the components of <span class="math inline">\(\mathbf E\)</span> depend on both the direction of the dipole moment and the direction to the source.</p>
<p>Check:</p>
<p>With</p>
<p><span class="math display">\[
\mathbf m =
\begin{bmatrix}
0 \\ 0 \\ m
\end{bmatrix}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mathbf r =
\begin{bmatrix}
x \\ y \\ z
\end{bmatrix}
\]</span> we obtain <span class="math display">\[
- \mathbf m \times \mathbf r =
\begin{bmatrix}
my \\ -mx \\ 0
\end{bmatrix} =
\begin{bmatrix}
m r \sin\varphi \\ -m r \cos\varphi \\ 0
\end{bmatrix}
.
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Looking in the direction of the positive <span class="math inline">\(z\)</span>-axis of a right-handed coordinate system, the induced electric field is oriented counter-clockwise, when <span class="math inline">\(\mathbf m\)</span> is oriented in positive <span class="math inline">\(z\)</span>-direction.</p>
</div>
</div>
</section>
<section id="magnetic-field" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="magnetic-field"><span class="header-section-number">7.7.2</span> Magnetic field</h3>
<p>For the magnetic field, we need</p>
<p><span class="math display">\[
\mathbf H = -\sigma \mathbf F + \frac{1}{i\omega\mu} \grad \divergence \mathbf F = \frac{1}{i\omega\mu} \left(
    k^2 \mathbf F + \grad\divergence \mathbf F
\right).
\]</span></p>
<p>The <span class="math inline">\(\nabla\cdot\)</span>-operator requires the calculation of <span class="math inline">\(\partial_z F_z\)</span>, whereas the gradient requires to provide all partial derivatives of <span class="math inline">\(\partial_z F_z\)</span> with respect to <span class="math inline">\(r\)</span> and <span class="math inline">\(z\)</span>.</p>
<p>We recall that</p>
<p><span class="math display">\[
r = \sqrt{x^2 + y^2 + z^2}
\]</span></p>
<p>and use the chain rule to obtain</p>
<p><span class="math display">\[
\partial_z F_z = \partial_r F_z \cdot \partial_z r,
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\partial_z r = \frac{ z }{ r}.
\]</span></p>
<p>Further, the divergence and gradient operators generally read in cylindrical coordinates for a vector field <span class="math inline">\(\mathbf F\)</span> and a scalar field <span class="math inline">\(f\)</span></p>
<p><span class="math display">\[
\divergence \mathbf F = \frac{1}{r} \partial_r(r F_r) +
\frac{1}{r} \partial_\varphi F_\varphi +
\partial_z F_z
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\grad f = \partial_r f \mathbf e_r +
\frac{1}{r} \partial_\varphi f \mathbf e_\varphi +
\partial_z f \mathbf e_z.
\]</span></p>
<p>In our case we need to calculate</p>
<p><span class="math display">\[
\divergence \mathbf F = \partial_z F_z.
\]</span></p>
<p>To compute the derivatives, we use <code>sympy</code>:</p>
<div id="f31cded7" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy <span class="im">import</span> diff, symbols, sqrt, pi, exp, I, simplify, Derivative, Matrix</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x, y, z, r, omega, mu, sigma, m <span class="op">=</span> symbols(<span class="st">'x y z r omega mu_0 sigma m'</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> symbols(<span class="st">'k'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Fz <span class="op">=</span> I <span class="op">*</span> omega <span class="op">*</span> mu <span class="op">*</span> m <span class="op">/</span> (<span class="dv">4</span> <span class="op">*</span> pi <span class="op">*</span> r) <span class="op">*</span> exp(<span class="op">-</span>I <span class="op">*</span> k <span class="op">*</span> r)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Fz = '</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>Fz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fz = </code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="2">
<p><span class="math inline">\(\displaystyle \frac{i m \mu_{0} \omega e^{- i k r}}{4 \pi r}\)</span></p>
</div>
</div>
<p>Next, we implement an expression for <span class="math inline">\(\divergence \mathbf F\)</span>:</p>
<div id="359ad418" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>divF <span class="op">=</span> diff(Fz.subs(r, sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> z<span class="op">**</span><span class="dv">2</span>)), z).subs(sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> z<span class="op">**</span><span class="dv">2</span>), r).simplify()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'divF = '</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>divF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>divF = </code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="3">
<p><span class="math inline">\(\displaystyle \frac{m \mu_{0} \omega z \left(k r - i\right) e^{- i k r}}{4 \pi r^{3}}\)</span></p>
</div>
</div>
<p>The chain rule can be implemented by a <code>lambda</code> function <code>chain</code> which first substitutes <span class="math inline">\(r\)</span> by the square root, forms the derivative, and finally substitutes all square root expressions by <span class="math inline">\(r\)</span> or powers thereof.</p>
<div id="6c7867ff" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="kw">lambda</span> F, v: diff(F.subs(r, sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> z<span class="op">**</span><span class="dv">2</span>)), v).subs(sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> z<span class="op">**</span><span class="dv">2</span>), r).simplify()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A call to <code>chain</code>, i.e., the implementation of <span class="math inline">\(\partial_z \partial_z F_z\)</span> would simply look as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>chain(Fz, z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However, to get the magentic field components, we need to divide by the term <span class="math inline">\(i \omega \mu_0\)</span>.</p>
<div id="0628b5ae" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Hx <span class="op">=</span> chain(divF, x).factor() <span class="op">/</span> (I <span class="op">*</span> omega <span class="op">*</span> mu)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Hx ='</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>Hx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hx =</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="5">
<p><span class="math inline">\(\displaystyle - \frac{m x z \left(k^{2} r^{2} - 3 i k r - 3\right) e^{- i k r}}{4 \pi r^{5}}\)</span></p>
</div>
</div>
<div id="cf40073e" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Hy <span class="op">=</span> chain(divF, y).factor() <span class="op">/</span> (I <span class="op">*</span> omega <span class="op">*</span> mu)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Hy ='</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Hy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hy =</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="6">
<p><span class="math inline">\(\displaystyle - \frac{m y z \left(k^{2} r^{2} - 3 i k r - 3\right) e^{- i k r}}{4 \pi r^{5}}\)</span></p>
</div>
</div>
<p>To get <span class="math inline">\(H_z\)</span> we have to add the term <span class="math inline">\(k^2 F_z\)</span> as</p>
<div id="24b2d613" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Hz <span class="op">=</span> (chain(divF, z) <span class="op">+</span> k<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Fz) <span class="op">/</span> (I <span class="op">*</span> omega <span class="op">*</span> mu)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Hz ='</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>Hz.factor().simplify()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hz =</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="7">
<p><span class="math inline">\(\displaystyle \frac{m \left(k^{2} r^{4} - k^{2} r^{2} z^{2} - i k r^{3} + 3 i k r z^{2} - r^{2} + 3 z^{2}\right) e^{- i k r}}{4 \pi r^{5}}\)</span></p>
</div>
</div>
<p>We can generalize using the following notation:</p>
<p><span class="math display">\[
\mathbf H(\mathbf r) = \frac{1}{4 \pi r^3} \left[
    \frac{\mathbf m \cdot \mathbf r}{r^2} (3 + 3 i k r - k^2 r^2) \mathbf r - (1 + i k r - k^2 r^2) \mathbf m
    \right] e^{-i k r}.
\]</span></p>
<p>Let’s check the validity on our example.</p>
<p>We introduce the symbolic vector quantities <code>M</code> and <code>R</code>, and implement a <code>lambda</code> function to express the magnetic field with respect to the orientation of the magnetic dipole moment:</p>
<div id="d007c378" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> Matrix([<span class="dv">0</span>, <span class="dv">0</span>, m])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> Matrix([x, y, z])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> <span class="kw">lambda</span> M: (M.dot(R) <span class="op">*</span> (<span class="dv">3</span> <span class="op">+</span> I <span class="op">*</span> k <span class="op">*</span> r <span class="op">-</span> k<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> r<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> R <span class="op">/</span> r<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> (<span class="dv">1</span> <span class="op">+</span> I <span class="op">*</span> k <span class="op">*</span> r <span class="op">-</span> k<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> r<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> M) <span class="op">*</span> exp(<span class="op">-</span>I <span class="op">*</span> k <span class="op">*</span> r) <span class="op">/</span> (<span class="dv">4</span> <span class="op">*</span> pi <span class="op">*</span> r<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'H(M) ='</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>H(M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>H(M) =</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="8">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}\frac{m x z \left(- k^{2} r^{2} + i k r + 3\right) e^{- i k r}}{4 \pi r^{5}}\\\frac{m y z \left(- k^{2} r^{2} + i k r + 3\right) e^{- i k r}}{4 \pi r^{5}}\\\frac{\left(- m \left(- k^{2} r^{2} + i k r + 1\right) + \frac{m z^{2} \left(- k^{2} r^{2} + i k r + 3\right)}{r^{2}}\right) e^{- i k r}}{4 \pi r^{3}}\end{matrix}\right]\)</span></p>
</div>
</div>
<p>This confirms the correctness of our derivation.</p>
</section>
</section>
<section id="apparent-resistivity" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="apparent-resistivity"><span class="header-section-number">7.8</span> Apparent resistivity</h2>
<p>However, geophysics is primarily interested in reconstructing the spatial distribution of electrical conductivity from measured field quantities (inversion). This step is based on a model conception of the spatial conductivity distribution. In general, the conductivity is a function of location with <span class="math inline">\(\sigma=\sigma(x,y,z)&gt;0\)</span>. In the simplest case, we assume that the halfspace or fullspace is a uniform conductor, i.e., <span class="math inline">\(\sigma= const\)</span>. The model of the homogeneous halfspace or fullspace can therefore be completely described by a single number. We now try to determine this number mathematically from the measured field quantities.</p>
<p>This is the simplest form of a geophysical inversion!</p>
<p>We use the <em>impedance</em> to solve the problem. From this we then determine the apparent resistivity.</p>
<p>The following questions will be answered:</p>
<ul>
<li>Can the concept of impedance be transferred to dipole excitation?</li>
<li>Is it possible to reconstruct the electrical resistivity from the impedance?</li>
<li>What are the differences compared to homogeneous excitation (MT)?</li>
</ul>
<p>We implement the general equations for the electric and magnetic fields as <code>Python</code> functions <code>E</code> and <code>H</code>, resp.:</p>
<div id="87c51437" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> E(r, m, f, sigma):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> np.pi <span class="op">*</span> <span class="fl">4e-7</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    omega <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> f</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    iwm <span class="op">=</span> <span class="ot">1j</span> <span class="op">*</span> omega <span class="op">*</span> mu</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> iwm <span class="op">/</span> (<span class="dv">4</span> <span class="op">*</span> np.pi)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> np.sqrt(<span class="op">-</span>iwm <span class="op">*</span> sigma)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> r[<span class="dv">0</span>]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> r[<span class="dv">1</span>]</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> r[<span class="dv">2</span>]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> np.linalg.norm(r)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    ikr <span class="op">=</span> <span class="ot">1j</span> <span class="op">*</span> k <span class="op">*</span> R</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    E <span class="op">=</span> <span class="op">-</span>alpha <span class="op">/</span> R<span class="op">**</span><span class="dv">3</span> <span class="op">*</span> (<span class="fl">1.0</span> <span class="op">+</span> ikr) <span class="op">*</span> np.exp(<span class="op">-</span>ikr) <span class="op">*</span> np.cross(m, r)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> E</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> H(r, m, f, sigma):</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> np.pi <span class="op">*</span> <span class="fl">4e-7</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    omega <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> f</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    iwm <span class="op">=</span> <span class="ot">1j</span> <span class="op">*</span> omega <span class="op">*</span> mu</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> np.sqrt(<span class="op">-</span>iwm <span class="op">*</span> sigma)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> r[<span class="dv">0</span>]</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> r[<span class="dv">1</span>]</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> r[<span class="dv">2</span>]</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> np.linalg.norm(r)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    ikr <span class="op">=</span> <span class="ot">1j</span> <span class="op">*</span> k <span class="op">*</span> R</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    k2r2 <span class="op">=</span> k<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> R<span class="op">**</span><span class="dv">2</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> np.exp(<span class="op">-</span>ikr) <span class="op">/</span> (<span class="dv">4</span> <span class="op">*</span> np.pi <span class="op">*</span> R<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> (</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>            np.dot(m, r) <span class="op">/</span> R<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (<span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> ikr <span class="op">-</span> k2r2) <span class="op">*</span> r</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span> <span class="op">+</span> ikr <span class="op">-</span> k2r2) <span class="op">*</span> m</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> H</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We check with the parameters defining a VMD in horizontal coplanar configuration oscillating at a frequency of 100 Hz located at the origin of a uniform fullspace:</p>
<ul>
<li><span class="math inline">\(\mathbf r = [100, 0, 0]^\top\)</span> m</li>
<li><span class="math inline">\(\mathbf m = [0, 0, 1]^\top\)</span> A<span class="math inline">\(\cdot m^2\)</span></li>
<li><span class="math inline">\(f = 100\)</span> Hz</li>
<li><span class="math inline">\(\sigma = 0.01\)</span> S/m.</li>
</ul>
<p>Let’s have a look at the electric field evaluated with the function <code>E</code>:</p>
<div id="f01a90e6" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> np.array([<span class="fl">100.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fl">100.0</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>e <span class="op">=</span> E(r, m, f, sigma)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>Ey <span class="op">=</span> e[<span class="dv">1</span>]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.array_str(e, precision<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[ 0.00e+00-0.00e+00j -2.15e-10-6.25e-09j  0.00e+00-0.00e+00j]</code></pre>
</div>
</div>
<p>Now let’s evaluate the magnetic field using <code>H</code>:</p>
<div id="ca595fd8" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> H(r, m, f, sigma)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Hz <span class="op">=</span> h[<span class="dv">2</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.array_str(h, precision<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[ 0.00e+00+0.00e+00j  0.00e+00+0.00e+00j -8.02e-08-2.32e-09j]</code></pre>
</div>
</div>
<p>We recognize that for a vertically aligned dipole, when observed at the <span class="math inline">\(x\)</span>-axis, only the <span class="math inline">\(y\)</span>-component of <span class="math inline">\(\mathbf E\)</span> and the <span class="math inline">\(z\)</span>-component of <span class="math inline">\(\mathbf H\)</span> are non-zero.</p>
<p>Now we try to calculate the <em>impedance</em> from the ratio of two mutually orthogonal components of <span class="math inline">\(\mathbf E\)</span> and <span class="math inline">\(\mathbf H\)</span>, e.g.,</p>
<p><span class="math display">\[
Z = \frac{ E_y }{ H_z}.
\]</span></p>
<p>The result is complex number:</p>
<div id="d5bd3b8f" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Ey <span class="op">/</span> Hz</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>np.set_printoptions()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(precision<span class="op">=</span><span class="dv">2</span>, floatmode<span class="op">=</span><span class="st">'fixed'</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Z = '</span> <span class="op">+</span> <span class="bu">str</span>(np.<span class="bu">round</span>(Z, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Z = (0.0049+0.0778j)</code></pre>
</div>
</div>
<p>For the calculation of the apparent resistivity, we use</p>
<p><span class="math display">\[
\rho_a = \frac{ 1 }{ \omega \mu_0} |Z|^2
\]</span></p>
<div id="fb3d43e7" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rhoa(Z, f):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> np.pi <span class="op">*</span> <span class="fl">4e-7</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    omega <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> f</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">abs</span>(Z)<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> (omega <span class="op">*</span> mu)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The apparent resistivity is '</span> <span class="op">+</span> <span class="bu">str</span>(np.<span class="bu">round</span>(rhoa(Z, f), <span class="dv">4</span>)) <span class="op">+</span> <span class="st">' Ohm*m.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The apparent resistivity is 7.6995 Ohm*m.</code></pre>
</div>
</div>
<p>This does not meet our expectations. We are therefore investigating whether the impedance depends on the frequency and/or the distance to the dipole.</p>
<p>We vary the frequencies and observe <span class="math inline">\(\rho_a\)</span> as a function of frequency.</p>
<div id="2d0f4836" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>nf <span class="op">=</span> <span class="dv">41</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> np.logspace(<span class="dv">1</span>, <span class="dv">5</span>, nf, endpoint<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Rhoa_f <span class="op">=</span> [rhoa(E(r,m,v,sigma)[<span class="dv">1</span>] <span class="op">/</span> H(r,m,v,sigma)[<span class="dv">2</span>], v) <span class="cf">for</span> v <span class="kw">in</span> freq]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="10be06c3" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ax.loglog(freq, Rhoa_f, label<span class="op">=</span><span class="vs">r'$\rho_a$'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'f in Hz'</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$\rho_a~in~\Omega\cdot m$'</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Dipole offset '</span> <span class="op">+</span> <span class="bu">str</span>(np.linalg.norm(r)) <span class="op">+</span> <span class="st">' m'</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="fl">1e2</span>, color<span class="op">=</span><span class="st">'C1'</span>, label<span class="op">=</span><span class="vs">r'true $\rho$'</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>ax</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="potentials_files/figure-html/cell-16-output-1.png" width="519" height="377" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Obviously, the value of <span class="math inline">\(\rho_a\)</span> depends on the frequency and asymptotically approaches the expected full-space value of the resistivity as <span class="math inline">\(f \to \infty\)</span>.</p>
<p>We gain more insight, when we vary the distance to the dipole while keeping the frequency fixed.</p>
<div id="0ab051aa" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>nr <span class="op">=</span> <span class="dv">41</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.logspace(<span class="dv">0</span>, <span class="dv">4</span>, nr, endpoint<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>Rhoa_x <span class="op">=</span> np.array([rhoa(E(np.array([v, <span class="dv">0</span>, <span class="dv">0</span>]),m,f,sigma)[<span class="dv">1</span>] <span class="op">/</span> H(np.array([v, <span class="dv">0</span>, <span class="dv">0</span>]),m,f,sigma)[<span class="dv">2</span>], f) <span class="cf">for</span> v <span class="kw">in</span> x])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="33160ec9" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ax.loglog(x, Rhoa_x, label<span class="op">=</span><span class="vs">r'$\rho_a$'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="fl">1e2</span>, color<span class="op">=</span><span class="st">'C1'</span>, label<span class="op">=</span><span class="vs">r'true $\rho$'</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'r in m'</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$\rho_a~in~\Omega\cdot m$'</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Frequency '</span> <span class="op">+</span> <span class="bu">str</span>(np.linalg.norm(f)) <span class="op">+</span> <span class="st">' Hz'</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>ax</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="potentials_files/figure-html/cell-18-output-1.png" width="526" height="377" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Is there a consistent explanation for these observations? We look at the induction parameter <span class="math inline">\(|k|r\)</span> and revisit the parameters from the previous examples.</p>
<div id="4199b8be" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kr(f, sigma, r):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> np.pi <span class="op">*</span> <span class="fl">4e-7</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    omega <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> f</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r <span class="op">*</span> np.<span class="bu">abs</span>(np.sqrt(<span class="op">-</span><span class="ot">1j</span> <span class="op">*</span> omega <span class="op">*</span> mu <span class="op">*</span> sigma))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pos(data, threshold):</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.where(np.array(data) <span class="op">&gt;</span> threshold, data, np.nan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="7aff4f53" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>KR <span class="op">=</span> np.array([kr(v, sigma, np.linalg.norm(r)) <span class="cf">for</span> v <span class="kw">in</span> freq])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>ax.loglog(freq, KR, color<span class="op">=</span><span class="st">'C1'</span>, label<span class="op">=</span><span class="vs">r'|k|r &gt; 1'</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>iind <span class="op">=</span> np.argwhere(KR <span class="op">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>ax.loglog(freq[iind], KR[iind], color<span class="op">=</span><span class="st">'C0'</span>, label<span class="op">=</span><span class="vs">r'|k|r &lt; 1'</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$|k|r$'</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'f in Hz'</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Dipole offset '</span> <span class="op">+</span> <span class="bu">str</span>(np.linalg.norm(r)) <span class="op">+</span> <span class="st">' m'</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>ax</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="potentials_files/figure-html/cell-20-output-1.png" width="527" height="377" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>With the indicator <span class="math inline">\(|k|r\)</span> just introduced, it is easier to determine which branch of the asymptotic we are on.</p>
<div id="1b8e2f37" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>KR <span class="op">=</span> np.array([kr(f, sigma, v) <span class="cf">for</span> v <span class="kw">in</span> x])</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>ax.loglog(x, Rhoa_x, color<span class="op">=</span><span class="st">'C1'</span>, label<span class="op">=</span><span class="vs">r'$|k|r &gt; 1$'</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>iind <span class="op">=</span> np.argwhere(KR <span class="op">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>ax.loglog(x[iind], Rhoa_x[iind], color<span class="op">=</span><span class="st">'C0'</span>, label<span class="op">=</span><span class="vs">r'$|k|r &lt; 1$'</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'r in m'</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$\rho_a~in~\Omega\cdot m$'</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Frequency '</span> <span class="op">+</span> <span class="bu">str</span>(np.linalg.norm(f)) <span class="op">+</span> <span class="st">' Hz'</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>ax</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="potentials_files/figure-html/cell-21-output-1.png" width="526" height="377" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In contrast to homogeneous excitation, the impedance and thus the apparent resistivity for dipole excitation depends not only on the frequency but also on the distance between the dipole source and the receiver. At <span class="math inline">\(|k|r \gg 1\)</span> we speak of the far zone. The impedance relationships there are similar to those for the MT. At <span class="math inline">\(|k|r \ll 1\)</span> we are in the near zone. The induction parameter is small. The low induction number (LIN) methods work in this regime. With the Geonics EM-34, for example, a coil distance of around 10 m is selected at a frequency of 6,400 Hz. The induction parameter for this configuration is less than 1 if the conductivity is sufficiently low.</p>
<p>We check these findings for a range of conductivities.</p>
<div id="cell-fig-lin-response" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ns <span class="op">=</span> <span class="dv">41</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">0</span>, ns, endpoint<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">10.0</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fl">6400.0</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>KR <span class="op">=</span> np.array([kr(f, v, r) <span class="cf">for</span> v <span class="kw">in</span> sigma])</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>Hz <span class="op">=</span> np.array([H(np.array([r, <span class="dv">0</span>, <span class="dv">0</span>]), np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>]), f, v)[<span class="dv">2</span>] <span class="cf">for</span> v <span class="kw">in</span> sigma])</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>ax1.loglog(KR, np.<span class="bu">abs</span>(np.real(Hz)))</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>ax1.axvspan(KR[<span class="dv">0</span>], <span class="fl">1.0</span>, facecolor<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, label<span class="op">=</span><span class="vs">r'$|k|r&lt;1$'</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>ax1.axvspan(<span class="fl">1.0</span>, KR[<span class="op">-</span><span class="dv">1</span>], facecolor<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, label<span class="op">=</span><span class="vs">r'$|k|r&gt;1$'</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="vs">r'$|Re(H_z)|$'</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>ax2.loglog(KR, np.<span class="bu">abs</span>(np.imag(Hz)))</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>ax2.axvspan(KR[<span class="dv">0</span>], <span class="fl">1.0</span>, facecolor<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, label<span class="op">=</span><span class="vs">r'$|k|r&lt;1$'</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>ax2.axvspan(<span class="fl">1.0</span>, KR[<span class="op">-</span><span class="dv">1</span>], facecolor<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, label<span class="op">=</span><span class="vs">r'$|k|r&gt;1$'</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="vs">r'$|k|r$'</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="vs">r'$|Im(H_z)|$'</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-lin-response" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lin-response-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="potentials_files/figure-html/fig-lin-response-output-1.png" width="549" height="359" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lin-response-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Real and imaginary part of the magnetic field of an oscillating magnetic dipole. The green and red shading indicates the regime for <span class="math inline">\(|k|r &lt; 1\)</span> and <span class="math inline">\(|k|r &gt; 1\)</span>, resp.
</figcaption>
</figure>
</div>
</div>
</div>
<p>As we can see from Fig. <a href="#fig-lin-response" class="quarto-xref">Figure&nbsp;<span>7.1</span></a>, the real part of the magnetic field goes to a constant value for <span class="math inline">\(|k|r \to 0\)</span>, whereas the imaginary part shows a straight line in the log-log plot.</p>
<p>For <span class="math inline">\(|k|r \to 0\)</span>, i.e., for very small conductivities, we approach free-space conditions. The magnetic field of a vertical dipole in horizontal co-planar configuration is</p>
<p><span class="math display">\[
H_z = -\frac{ m }{4 \pi r^3 }.
\]</span></p>
<p>We evaluate this equation with the given values of <span class="math inline">\(r\)</span> and <span class="math inline">\(m\)</span>. We obtain</p>
<div id="14422a65" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'H_z   = '</span> <span class="op">+</span> <span class="bu">str</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">/</span> (<span class="dv">4</span> <span class="op">*</span> np.pi <span class="op">*</span> r<span class="op">**</span><span class="dv">3</span>)))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Hz[0] = '</span> <span class="op">+</span> <span class="bu">str</span>(np.real(Hz[<span class="dv">0</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>H_z   = -7.957747154594768e-05
Hz[0] = -7.957789009530794e-05</code></pre>
</div>
</div>
<p>These numbers match very well.</p>
<p>On the other hand, for fixed values of <span class="math inline">\(r\)</span> and <span class="math inline">\(f\)</span> it is possible to calibrate the instrument such that the reading of the imaginary part of <span class="math inline">\(H_z\)</span> for low induction numbers yields the desired apparent resistivity.</p>
<section id="instrument-error" class="level3" data-number="7.8.1">
<h3 data-number="7.8.1" class="anchored" data-anchor-id="instrument-error"><span class="header-section-number">7.8.1</span> Instrument error</h3>
<p>What about the uncertainty of the readings of such an instrument?</p>
<p>Frequency stability in the instrument is not a problem. The situation is different when measuring the distance between the coils. We therefore finally examine the sensitivity of the magnetic field measurement to inaccuracies in the distance measurement. To do this, we consider the error according to the linear error propagation law</p>
<p><span class="math display">\[
\Delta H_z = \left| \frac{\partial H_z}{\partial r} \right| \Delta r.
\]</span></p>
<p>For the magnetic field in the coplanar coil configuration in free space, we obtain</p>
<p><span class="math display">\[
\Delta H_z = \frac{3 m}{4 \pi r^4} \Delta r,
\]</span></p>
<p>which results in an estimate of the relative error</p>
<p><span class="math display">\[
\frac{\Delta H_z}{H_z} = 3 \frac{\Delta r}{r} .
\]</span></p>
<p>Accordingly, the relative error in the magnetic field measurement is three times as large as the relative error in the distance measurement.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Abramowitz1972" class="csl-entry" role="listitem">
Abramowitz, M. &amp; Stegun, I.A., 1972. <em>Handbook of mathematical functions with formulas, graphs, and mathematical tables</em>, Tenth., <span>Dover Publications</span>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./mtfields.html" class="pagination-link" aria-label="Plane waves above and inside a homogeneous Earth">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plane waves above and inside a homogeneous Earth</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./timedomain_fullspace.html" class="pagination-link" aria-label="Fields in the time domain">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fields in the time domain</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>