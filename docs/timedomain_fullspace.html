<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Fields in the time domain – Theory of Electromagnetic Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./halfspace.html" rel="next">
<link href="./potentials.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
window.MathJax = {
  loader: {
    load: ['[tex]/physics']
  },
  tex: {
    packages: {'[+]': ['physics']}
  }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./potentials.html">Dipole induction</a></li><li class="breadcrumb-item"><a href="./timedomain_fullspace.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fields in the time domain</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Theory of Electromagnetic Methods</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prerequisites</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Electromagnetic fields</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Fourier transform</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Maxwell’s equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maxwell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Maxwell’s Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pde.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Partial Differential Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mtfields.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plane waves above and inside a homogeneous Earth</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Dipole induction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./potentials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sources in unbounded media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./timedomain_fullspace.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fields in the time domain</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./halfspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dipole sources above a uniform halfspace</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explicit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Explicit expressions for the fields in HCP configuration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hankel_transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Numerical calculation of the EM Hankel integrals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./layered_halfspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Dipole sources above a layered halfspace</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./timedomain_halfspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Dipole induction over a layered halfspace in the time domain</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Summary</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">8.1</span> Introduction</a></li>
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology"><span class="header-section-number">8.2</span> Terminology</a>
  <ul class="collapse">
  <li><a href="#step-function-response" id="toc-step-function-response" class="nav-link" data-scroll-target="#step-function-response"><span class="header-section-number">8.2.1</span> Step function response</a></li>
  <li><a href="#impulse-response" id="toc-impulse-response" class="nav-link" data-scroll-target="#impulse-response"><span class="header-section-number">8.2.2</span> Impulse response</a></li>
  <li><a href="#differentiation-integration-convolution" id="toc-differentiation-integration-convolution" class="nav-link" data-scroll-target="#differentiation-integration-convolution"><span class="header-section-number">8.2.3</span> Differentiation, integration, convolution</a></li>
  <li><a href="#causal-systems" id="toc-causal-systems" class="nav-link" data-scroll-target="#causal-systems"><span class="header-section-number">8.2.4</span> Causal systems</a></li>
  <li><a href="#sec-laplace" id="toc-sec-laplace" class="nav-link" data-scroll-target="#sec-laplace"><span class="header-section-number">8.2.5</span> Laplace transform</a></li>
  </ul></li>
  <li><a href="#inverse-transform-of-the-electric-field-with-step-function-excitation" id="toc-inverse-transform-of-the-electric-field-with-step-function-excitation" class="nav-link" data-scroll-target="#inverse-transform-of-the-electric-field-with-step-function-excitation"><span class="header-section-number">8.3</span> Inverse transform of the electric field with step function excitation</a>
  <ul class="collapse">
  <li><a href="#error-function" id="toc-error-function" class="nav-link" data-scroll-target="#error-function"><span class="header-section-number">8.3.1</span> Error function</a></li>
  <li><a href="#summary-of-all-terms" id="toc-summary-of-all-terms" class="nav-link" data-scroll-target="#summary-of-all-terms"><span class="header-section-number">8.3.2</span> Summary of all terms</a></li>
  </ul></li>
  <li><a href="#inverse-transform-of-the-magnetic-field-with-step-function-excitation" id="toc-inverse-transform-of-the-magnetic-field-with-step-function-excitation" class="nav-link" data-scroll-target="#inverse-transform-of-the-magnetic-field-with-step-function-excitation"><span class="header-section-number">8.4</span> Inverse transform of the magnetic field with step function excitation</a></li>
  <li><a href="#numerical-example" id="toc-numerical-example" class="nav-link" data-scroll-target="#numerical-example"><span class="header-section-number">8.5</span> Numerical example</a></li>
  <li><a href="#late-time-asymptotic-behaviour-and-apparent-resistivity" id="toc-late-time-asymptotic-behaviour-and-apparent-resistivity" class="nav-link" data-scroll-target="#late-time-asymptotic-behaviour-and-apparent-resistivity"><span class="header-section-number">8.6</span> Late-time asymptotic behaviour and apparent resistivity</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./potentials.html">Dipole induction</a></li><li class="breadcrumb-item"><a href="./timedomain_fullspace.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fields in the time domain</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fields in the time domain</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">8.1</span> Introduction</h2>
<p>So far, we have investigated fields as a function of location and frequency. This is adequate as long as we consider time-harmonic dipole excitation with a time dependency of the dipole moment of <span class="math inline">\(e^{i\omega t}\)</span>, i.e.</p>
<p><span class="math display">\[
\mathbf m(\mathbf r, \omega) = \mathbf m(\mathbf r) e^{i\omega t}.
\]</span></p>
<p>The relationships immediately become different if we allow abrupt changes in the dipole moment instead, e.g.,</p>
<p><span class="math display">\[
\mathbf m(\mathbf r, t) = \mathbf m(\mathbf r) \delta(t)
\]</span> or <span class="math display">\[
\mathbf m(\mathbf r, t) = \mathbf m(\mathbf r) u(t).
\]</span></p>
<p><span class="math inline">\(u(t)\)</span> is the <em>Heaviside step function</em> <span class="math display">\[
\begin{equation}
u(t) =
\begin{cases}
0 &amp; t &lt; 0 \\
1 &amp; t &gt; 0.
\end{cases}
\end{equation}
\]</span></p>
<p>The following figures show the Heaviside function <span class="math inline">\(u(t)\)</span> and the result of the time integration of the Dirac delta function <span class="math inline">\(\delta(t)\)</span>.</p>
<p>We use the symbolic expressions <code>t</code> for the time as well as <code>Heaviside</code> and <code>DiracDelta</code> for step function and Dirac’s delta function respectively. Furthermore, we use the function <code>integrate</code> for symbolic integration.</p>
<div id="5205054f" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy <span class="im">import</span> symbols, diff, Heaviside, DiracDelta, integrate, plot, sqrt, exp, oo, erf, erfc, pi</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> symbols(<span class="st">'t'</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>plot(Heaviside(t), (t, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), size<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">3</span>), title<span class="op">=</span><span class="st">'Heaviside'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="timedomain_fullspace_files/figure-html/cell-2-output-1.png" width="566" height="277" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The following figure shows the result of the time integration of the Dirac delta function, where the integral over <span class="math inline">\(\delta(t)\)</span> from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(t\)</span> is assigned to the value of a function at time <span class="math inline">\(t\)</span>.</p>
<div id="d4968c49" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plot(integrate(DiracDelta(t), t), (t, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), size<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">3</span>), title<span class="op">=</span><span class="vs">r'$\int_{-\infty}^t\delta(\tau) d\tau$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="timedomain_fullspace_files/figure-html/cell-3-output-1.png" width="566" height="276" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Both figures obviously show the same result. So the following applies <span class="math display">\[
u(t) = \int\limits_{-\infty}^t \delta(\tau) \, \mathrm d \tau.
\]</span></p>
<p>We can reproduce the result using symbolic mathematics.</p>
<p>(In <code>sympy</code> the Heaviside function has the symbol <span class="math inline">\(\theta\)</span>).</p>
<div id="f17f5ba3" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>integrate(DiracDelta(t), t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="3">
<p><span class="math inline">\(\displaystyle \theta\left(t\right)\)</span></p>
</div>
</div>
<p>Conversely, the following applies to the time derivative of the Heaviside function <span class="math display">\[
\frac{\mathrm d}{\mathrm dt} u(t) = \delta(t),
\]</span> of which we can convince ourselves by symbolic differentiation:</p>
<div id="e8fd4463" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>diff(Heaviside(t), t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="4">
<p><span class="math inline">\(\displaystyle \delta\left(t\right)\)</span></p>
</div>
</div>
</section>
<section id="terminology" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="terminology"><span class="header-section-number">8.2</span> Terminology</h2>
<p>We will use two important terms in the time domain, namely</p>
<ul>
<li>step function response and</li>
<li>impulse response.</li>
</ul>
<p>These terms are related to the time dependence of the current function of the dipole moment.</p>
<p>In general, the dipole moment is a function of location and time, i.e., <span class="math inline">\(\mathbf m(\mathbf r, t) = \mathbf q(\mathbf r) I(t)\)</span>. Here, <span class="math inline">\(\mathbf q(\mathbf r)\)</span> describes the exact position of the current-carrying cable (e.g., a large horizontal coil on the Earth’s surface) and <span class="math inline">\(I(t)\)</span> the time dependence of the current in this coil.</p>
<p>In the following, we only consider the time dependence of the dipole moment, i.e., <span class="math inline">\(I(t)\)</span>.</p>
<section id="step-function-response" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="step-function-response"><span class="header-section-number">8.2.1</span> Step function response</h3>
<p>The fields that we can measure anywhere in the full space as a direct result of switching the source current on or off are called the <em>step function response</em> of the electrically conductive full space</p>
<p>A current function of the form</p>
<p><span class="math display">\[
I(t) = I_0 u(t)
\]</span></p>
<p>describes the switching on of a current in the source at the time <span class="math inline">\(t=0\)</span> in the form of a step function. The fields <span class="math inline">\(\mathbf e(t)\)</span> and <span class="math inline">\(\mathbf b(t)\)</span> observed for <span class="math inline">\(t &gt; 0\)</span> are called step function response. These fields are measured with electrodes or magnetometers.</p>
</section>
<section id="impulse-response" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="impulse-response"><span class="header-section-number">8.2.2</span> Impulse response</h3>
<p>The current function</p>
<p><span class="math display">\[
I(t) = I_0 \delta(t)
\]</span></p>
<p>describes an impulse-like source current (“lightning”), which, however, cannot be realized in an instrument and is difficult to measure.</p>
<p>How can we measure the impulse response?</p>
<p>The following idea is interesting: If you measure magnetic fields with induction coils, the physical measured variable is the electrical voltage induced in the measuring coil, which is proportional to the change in the magnetic field over time.</p>
<p>Induction coils measure <span class="math inline">\(\partial_t b(t)\)</span>, i.e.&nbsp;the time derivative of the step function response <span class="math inline">\(b(t)\)</span>!</p>
<p>How can this relationship be described?</p>
<p>We have already seen above that the integration of the Dirac delta function with respect to time yields the Heaviside jump function. Conversely, the time derivative of the step function yields the delta function, i.e.&nbsp;a <em>Dirac impulse</em>.</p>
<p>We transfer this concept to the fields:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>field size</th>
<th>time dependence of the source</th>
<th>term</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\mathbf e(t),\mathbf b(t)\)</span></td>
<td><span class="math inline">\(u(t)\)</span></td>
<td>Step function response</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\frac{d}{dt} \mathbf b(t)\)</span></td>
<td><span class="math inline">\(\frac{d}{dt} u(t)\)</span></td>
<td>impulse response</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\frac{d}{dt} \mathbf b(t)\)</span></td>
<td><span class="math inline">\(\delta(t)\)</span></td>
<td>impulse response</td>
</tr>
</tbody>
</table>
</section>
<section id="differentiation-integration-convolution" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="differentiation-integration-convolution"><span class="header-section-number">8.2.3</span> Differentiation, integration, convolution</h3>
<p>We now derive an important relationship between the impulse response and the step function response.</p>
<p>Let <span class="math inline">\(h(t)\)</span> be the impulse response.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The impulse response <span class="math inline">\(h(t)\)</span> used here a physically unspecified function of time, <strong>not the magnetic field</strong>!</p>
</div>
</div>
<p>We then obtain the <a href="https://en.wikipedia.org/wiki/Step_response">step function response</a> <span class="math inline">\(f(t)\)</span> from the <em>convolution</em> of the impulse response <span class="math inline">\(h(t)\)</span> with the Heaviside function <span class="math inline">\(u(t)\)</span>:</p>
<p><span class="math display">\[
f(t)=(h * u)(t)=(u * h)(t) =\underbrace{\int_{-\infty}^{\infty} h(t') u(t-t') \dd t'}_{f_1(t)} = \underbrace{\int_{-\infty}^{t} h(t') \dd t'}_{
f_2(t)}
\]</span></p>
<p>The step function response at time <span class="math inline">\(t\)</span> is therefore the result of the time integration over the impulse response from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(t\)</span>.</p>
<p>In the following example, we assume that the impulse response is <span class="math inline">\(h(t) = e^{-t^2}\)</span>.</p>
<div id="b1c0e8e3" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> h(t):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> exp(<span class="op">-</span>t<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plot(h(t), (t, <span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>), size<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">3</span>), ylabel<span class="op">=</span><span class="st">'h(t)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="timedomain_fullspace_files/figure-html/cell-6-output-1.png" width="566" height="276" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We define symbolic expressions for the integrals introduced above to calculate <span class="math inline">\(f(t)\)</span>:</p>
<p><span class="math display">\[
f_1(\tau) = \int_{-\infty}^{\infty} h(t) u(\tau-t) \dd t
\]</span> <span class="math display">\[
f_2(\tau) = \int_{-\infty}^{\tau} h(t) \dd t
\]</span></p>
<div id="b7a5f48a" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tau <span class="op">=</span> symbols(<span class="st">'tau'</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f1(tau):</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> integrate(h(t) <span class="op">*</span> Heaviside(tau <span class="op">-</span> t), (t, <span class="op">-</span>oo, oo))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f2(tau):</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> integrate(h(t), (t, <span class="op">-</span>oo, tau))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d89ad7ea" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>f1(tau)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="7">
<p><span class="math inline">\(\displaystyle \frac{\sqrt{\pi} \left(2 - \operatorname{erfc}{\left(\tau \right)}\right)}{2}\)</span></p>
</div>
</div>
<div id="bf303b0e" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>f2(tau)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="8">
<p><span class="math inline">\(\displaystyle \frac{\sqrt{\pi} \left(2 - \operatorname{erfc}{\left(\tau \right)}\right)}{2}\)</span></p>
</div>
</div>
<p>We see that both integrals yield the same result, so <span class="math inline">\(f(t) = f_1(t) = f_2(t)\)</span>. For further calculations, it is sufficient to use the integral</p>
<p><span class="math display">\[
f(\tau) = \int_{-\infty}^\tau h(t) \, \dd t.
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Both integrals involve the <em>complementary error function</em> <em>erfc</em>, which will be discussed later in more detail.</p>
</div>
</div>
</section>
<section id="causal-systems" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="causal-systems"><span class="header-section-number">8.2.4</span> Causal systems</h3>
<p>Only causal systems occur in geophysics. In causal processes, no fields (or changes in the fields) can be measured before the source has been switched on (or changed). The effect is observed as a consequence of one of the causes.</p>
<p>The step function response for <em>causal systems</em> is</p>
<p><span class="math display">\[
f_{\mathrm{on}}(t)=\int_{0}^{t} h(t') \, \dd t', \quad t \geq 0.
\]</span></p>
<div id="ed7ecddd" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f_on(tau):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> integrate(h(t), (t, <span class="dv">0</span>, tau))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>plot(f_on(t), (t, <span class="dv">0</span>, <span class="dv">10</span>), ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>), size<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">3</span>), title<span class="op">=</span><span class="vs">r'$f_\text</span><span class="sc">{on}</span><span class="vs">(t)$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="timedomain_fullspace_files/figure-html/cell-10-output-1.png" width="561" height="276" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>With <span class="math inline">\(u(-t) = 1 - u(t)\)</span> we obtain the step function response for the <em>switch-off</em> process, which plays a major role in transient electromagnetics in particular, but also in the induced polarization method in the time domain.</p>
<p><span class="math display">\[
f_{\text {off }}(t) =\int_{t}^{\infty} h(t') \dd t' = \int_{0}^{\infty} h(t') \dd t' - \int_{0}^{t} h(t') \dd t', \quad t \geq 0
\]</span></p>
<p>The integrals can be expressed by the step function response for causal systems <span class="math inline">\(f_{\text {on }}(t)\)</span>:</p>
<p><span class="math display">\[
f_{\text {off }}(t) = f_{\text {on }}(\infty) - f_{\text {on }}(t), \quad t \geq 0
\]</span></p>
<p>This means that all we need to calculate the step function response of transient electromagnetics is a routine that can calculate the step response for the switch-on process!</p>
<div id="dda62a96" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f_off(tau):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f_on(oo) <span class="op">-</span> f_on(tau)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plot(f_off(t), (t, <span class="dv">0</span>, <span class="dv">10</span>), ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>), size<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">3</span>), title<span class="op">=</span><span class="vs">r'$f_\text</span><span class="sc">{off}</span><span class="vs">(t)$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="timedomain_fullspace_files/figure-html/cell-11-output-1.png" width="561" height="276" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The figure for <span class="math inline">\(f_\text{on}(t)\)</span> shows the typical behaviour of a field build-up after the source is switched on. We observe an increase in the field and a transition to a stationary state for <span class="math inline">\(t \to \infty\)</span>.</p>
<p><span class="math inline">\(f_\text{off}(t)\)</span> shows the decay of the field, where the initial value at <span class="math inline">\(t=0\)</span> decreases monotonically for <span class="math inline">\(t &gt; 0\)</span> to disappear for <span class="math inline">\(t \to \infty\)</span>.</p>
</div>
</div>
<p>We will now deal with the transformation between the time and frequency domains. To do this, we need the <strong>Laplace transformation</strong> (LT) and its properties.</p>
<p>The starting point is the comparison of the curl-curl equation in the time domain and in the frequency domain.</p>
<p>In the <strong>frequency domain</strong> we require <span class="math inline">\(F\)</span> to be a solution to the PDE</p>
<p><span class="math display">\[
\begin{equation}
-\partial_{xx}^2 F + i\omega\mu\sigma F = -i\omega J^{e}
\end{equation}
\]</span> with <span class="math display">\[
\begin{equation}
J^e(\mathbf r, \omega) = q(\mathbf r).
\end{equation}
\]</span></p>
<p>In the <strong>time domain</strong>, the field <span class="math inline">\(f\)</span> solves the PDE</p>
<p><span class="math display">\[
\begin{equation}
-\partial_{xx}^2 f + \mu\sigma \partial_{t} f = -\partial_{t} j^{e}
\end{equation}
\]</span> with <span class="math display">\[
\begin{equation}
j^e(\mathbf r, t) = q(\mathbf r) \delta(t).
\end{equation}
\]</span></p>
<p>Observations:</p>
<p>In the frequency domain, there is no explicit dependence of the source current density <span class="math inline">\(J^e(\mathbf r, \omega)\)</span> on the frequency.</p>
<p>We conclude from this that in the time domain, the source current function <span class="math inline">\(j^e\)</span> can be explicitly represented by a Dirac impulse on the time axis. The solution of this curl-curl equation is the impulse response.</p>
<p>The solution of the curl-curl equation in the frequency domain is then obtained from the Fourier transform of the impulse response in the time domain.</p>
<p>To calculate the step function response in the frequency domain, we must calculate the explicit time dependence of <span class="math inline">\(j^e\)</span> using the step function <span class="math inline">\(u(t)\)</span></p>
<p><span class="math display">\[
j^e_s(t) = q(\mathbf r) u(t).
\]</span></p>
<p>We obtain the Fourier transform of the source term with step function excitation:</p>
<p><span class="math display">\[
J^e_s(\omega) = q(\mathbf r) \left(\pi \delta(\omega) + \frac{1}{i \omega}\right)
\]</span></p>
<p>The step function response in the frequency domain, <span class="math inline">\(F_s(\omega)\)</span>, is thus obtained formally by multiplying the Fourier transform of the impulse response by the Fourier transform of the step function as <span class="math display">\[
F_s(\omega) = F(\omega) \left(\pi \delta(\omega) + \frac{1}{i \omega}\right) .
\]</span></p>
<p>The inverse Fourier transformation finally provides the desired step function response in the time domain,</p>
<p><span class="math display">\[
\begin{align}
f_s(t) &amp; = \frac{1}{2\pi} \int\limits_{-\infty}^\infty
\left(\pi \delta(\omega) + \frac{1}{i \omega}\right) F(\omega) e^{i\omega t} \, \dd\omega \\ &amp; = \frac{F(0)}{2} +
\frac{1}{2\pi} \int\limits_{-\infty}^\infty
\frac{F(\omega)}{i\omega}
e^{i\omega t} \, \dd\omega
\end{align}
\]</span></p>
<p>Formally, the Fourier transform must be added to half the value of the field at <span class="math inline">\(\omega = 0\)</span>, where the values of <span class="math inline">\(F\)</span> to be transformed are multiplied by <span class="math inline">\(\frac{1}{i\omega}\)</span>.</p>
<p>This corresponds to the well-known integration property of integral transforms.</p>
<p>Mathematical problems in connection with switch-on or switch-off processes can be solved elegantly with the Laplace transform.</p>
</section>
<section id="sec-laplace" class="level3" data-number="8.2.5">
<h3 data-number="8.2.5" class="anchored" data-anchor-id="sec-laplace"><span class="header-section-number">8.2.5</span> Laplace transform</h3>
<p>Consider a function <span class="math inline">\(f(t)\)</span>, <span class="math inline">\(t &gt; 0\)</span>.</p>
<p>The Laplace transform can be applied to <span class="math inline">\(f(t)\)</span> as follows: <span class="math display">\[
\mathcal L(f(x, t))=\int_{0}^{\infty} e^{-s t} f(x, t) \dd t \equiv F(x, s)
\]</span> with <span class="math inline">\(x\)</span> as parameter.</p>
<p>The Laplace parameter <span class="math inline">\(s\)</span> is complex and extends the imaginary frequency term <span class="math inline">\(i\omega\)</span> of the FT by the real part <span class="math inline">\(a\)</span>, so that with <span class="math inline">\(s = a + i\omega\)</span> we have a complex-valued “frequency”. In this way, the Laplace transform can also deal with unstable signals <span class="math inline">\(f\)</span>, since for <span class="math inline">\(t \to \infty\)</span> the real part of <span class="math inline">\(s\)</span> ensures that the integrand is limited.</p>
<p>In connection with PDEs, we also need the LT of the time derivative of <span class="math inline">\(f(t)\)</span>, or short <span class="math inline">\(f_t(x, t) = \partial_t f(x, t)\)</span></p>
<p><span class="math display">\[
\mathcal L(f_t(x, t)),
\]</span></p>
<p>which we calculate using the Laplace integral introduced above via integration by parts: <span class="math display">\[
\begin{align}
\mathcal L(f_t(x, t) &amp; = \int\limits_{0}^{\infty} e^{-s t} f_{t}(x, t) \dd t \\ &amp; = \left.e^{-s t} f(x, t)\right|_{0} ^{\infty}+s \int\limits_{0}^{\infty} e^{-s t} f(x, t) \dd t \\ &amp; = s F(x, s)-f(x, 0).
\end{align}
\]</span></p>
<p>The following table contains some important Laplace transform pairs:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(f(t)\)</span></th>
<th><span class="math inline">\(\mathcal L(f(t))\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(u(t-a)\)</span></td>
<td><span class="math inline">\(\dfrac{e^{-as}}{s}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\delta(t-a)\)</span></td>
<td><span class="math inline">\(e^{-as}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(\dfrac{1}{s}\)</span></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="inverse-transform-of-the-electric-field-with-step-function-excitation" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="inverse-transform-of-the-electric-field-with-step-function-excitation"><span class="header-section-number">8.3</span> Inverse transform of the electric field with step function excitation</h2>
<p>The starting point is the equation for the electric field of a magnetic dipole in full space.</p>
<p>With <span class="math inline">\(r = |\mathbf r|\)</span> it holds</p>
<p><span class="math display">\[
    \mathbf E(\mathbf r, \omega) = - \frac{i \omega \mu}{4 \pi r^3} \left(1 + i k r\right) e^{-i k r} \mathbf m \times \mathbf r
\]</span></p>
<p>All terms that depend on the frequency are relevant for the transformation. Apart from the factor <span class="math inline">\(i\omega\)</span>, which we will deal with later, these are</p>
<p><span class="math display">\[
e^{-ikr}, \quad ikr e^{-ikr}
\]</span></p>
<p>and additionally</p>
<p><span class="math display">\[
\quad k^2 r^2 e^{-ikr}
\]</span></p>
<p>for the magnetic field.</p>
<p>With the function <span class="math inline">\(\Theta(t) = \sqrt{\frac{\mu\sigma}{4 t}}\)</span> we obtain the following expressions for the inverse Laplace transform (see <a href="https://secure.math.ubc.ca/~cbm/aands/page_1021.htm">Abramowitz &amp; Stegun</a>):</p>
<p><span id="eq-laplace-1"><span class="math display">\[
\mathcal L^{-1} \left( \frac{1}{s} e^{-ikr} \right) = \mathrm{erfc}(\Theta r)
\tag{8.1}\]</span></span></p>
<p><span id="eq-laplace-ikr"><span class="math display">\[
\mathcal L^{-1} \left( \frac{ikr}{s} e^{-ikr} \right) = \frac{2}{\sqrt{\pi}} \Theta r e^{-\Theta^2 r^2}
\tag{8.2}\]</span></span></p>
<p><span id="eq-laplace-k2r2"><span class="math display">\[
\mathcal L^{-1} \left( \frac{k^2 r^2}{s} e^{-ikr} \right) =
-\frac{4}{\sqrt{\pi}} \Theta^3 r^3 e^{-\Theta^2 r^2}
\tag{8.3}\]</span></span></p>
<section id="error-function" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="error-function"><span class="header-section-number">8.3.1</span> Error function</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Error_function">error function</a> erf<span class="math inline">\((t)\)</span> plays an important role. Its definition is <span id="eq-erf"><span class="math display">\[
\mathrm{erf}(t) = \frac{2}{\sqrt{\pi}} \int_0^t e^{-\tau^2} \dd\tau.
\tag{8.4}\]</span></span></p>
<p>The <em>complementary error function</em> erfc<span class="math inline">\((t)\)</span> is <span id="eq-erfc"><span class="math display">\[
\mathrm{erfc}(t) = 1 - \mathrm{erf}(t).
\tag{8.5}\]</span></span></p>
<p>We implement the error function again with <code>sympy</code>.</p>
<div id="a6489dd3" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plot(erf(t), (t,<span class="dv">0</span>,<span class="dv">2</span>), size<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">3</span>), title<span class="op">=</span><span class="st">'erf(t)'</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plot(erfc(t), (t,<span class="dv">0</span>,<span class="dv">2</span>), size<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">3</span>), title<span class="op">=</span><span class="st">'erfc(t)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="timedomain_fullspace_files/figure-html/cell-12-output-1.png" width="561" height="277" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="timedomain_fullspace_files/figure-html/cell-12-output-2.png" width="561" height="277" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-of-all-terms" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="summary-of-all-terms"><span class="header-section-number">8.3.2</span> Summary of all terms</h3>
<p>After the LT we first have</p>
<p><span class="math display">\[
\mathbf e(\mathbf r, t) = -\partial_t \frac{\mu}{4 \pi r^3} \left(
\mathrm{erfc}(\Theta r) + \frac{2}{\sqrt{\pi}} \Theta r e^{-\Theta^2 r^2}
\right) \mathbf m \times \mathbf r.
\]</span></p>
<p>We now carry out the derivative with respect to time. To do this, we need the chain rule again, since <span class="math inline">\(\Theta = \Theta(t)\)</span>.</p>
<div id="415913ed" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mu, sigma, r <span class="op">=</span> symbols(<span class="st">'mu_0 sigma r'</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Theta(t):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(mu <span class="op">*</span> sigma <span class="op">/</span> <span class="dv">4</span> <span class="op">/</span> t)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ex1 <span class="op">=</span> diff(erfc(Theta(t) <span class="op">*</span> r), t)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>ex2 <span class="op">=</span> diff(Theta(t) <span class="op">*</span> r <span class="op">*</span> exp(<span class="op">-</span>Theta(t)<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> r<span class="op">**</span><span class="dv">2</span>), t)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>ex <span class="op">=</span> ex1 <span class="op">+</span> <span class="dv">2</span> <span class="op">/</span> sqrt(pi) <span class="op">*</span> ex2</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>ex.subs(sqrt(mu <span class="op">*</span> sigma <span class="op">/</span> <span class="dv">4</span> <span class="op">/</span> t), Theta(t)).factor().simplify()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="12">
<p><span class="math inline">\(\displaystyle \frac{\mu_{0} r^{3} \sigma \sqrt{\frac{\mu_{0} \sigma}{t}} e^{- \frac{\mu_{0} r^{2} \sigma}{4 t}}}{4 \sqrt{\pi} t^{2}}\)</span></p>
</div>
</div>
<p>We slightly rewrite this term with the help of <span class="math inline">\(\Theta(t)\)</span> to get</p>
<p><span class="math display">\[
\frac{2}{\sqrt{\pi} t} \Theta^3 r^3 e^{-\Theta^2 r^2}.
\]</span></p>
<p>With the leading terms and the cross product we obtain the final result for the electric field as a step function response</p>
<p><span class="math display">\[
\mathbf e(\mathbf r, t) = -\frac{\mu}{4 \pi r^3}
\frac{2}{\sqrt{\pi} t} \Theta^3 r^3 e^{-\Theta^2 r^2}
\mathbf m \times \mathbf r.
\]</span></p>
<p>We implement this function using <code>Python</code>.</p>
<div id="b351820f" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Et(r, m, t, sigma):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> np.pi <span class="op">*</span> <span class="fl">4e-7</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> np.linalg.norm(r)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> np.sqrt(mu <span class="op">*</span> sigma <span class="op">/</span> <span class="dv">4</span> <span class="op">/</span> t)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    tr <span class="op">=</span> theta <span class="op">*</span> R</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    t2r2 <span class="op">=</span> tr<span class="op">**</span><span class="dv">2</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> <span class="op">-</span>mu <span class="op">/</span> <span class="dv">4</span> <span class="op">/</span> np.pi</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    E <span class="op">=</span> alpha <span class="op">/</span> R<span class="op">**</span><span class="dv">3</span> <span class="op">*</span> np.cross(m, r) <span class="op">*</span> <span class="dv">2</span>  <span class="op">/</span> (</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        np.sqrt(np.pi) <span class="op">*</span> t) <span class="op">*</span> (tr <span class="op">*</span> t2r2) <span class="op">*</span> np.exp(<span class="op">-</span>t2r2)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> E</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="04438219" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Et(np.array([<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">0</span>]), np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>]), <span class="fl">1e-6</span>, <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([ 4.5124908e-17, -0.0000000e+00, -0.0000000e+00])</code></pre>
</div>
</div>
</section>
</section>
<section id="inverse-transform-of-the-magnetic-field-with-step-function-excitation" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="inverse-transform-of-the-magnetic-field-with-step-function-excitation"><span class="header-section-number">8.4</span> Inverse transform of the magnetic field with step function excitation</h2>
<p>The starting point is again the equation for the magnetic field in the frequency domain.</p>
<p><span class="math display">\[
    \mathbf H(\mathbf r) = \frac{1}{4 \pi r^3} \left[
    \frac{\mathbf m \cdot \mathbf r}{r^2} (3 + 3 i k r - k^2 r^2) \mathbf r - (1 + i k r - k^2 r^2) \mathbf m
    \right] e^{-i k r}.
\]</span></p>
<p>With the expressions for the inverse Laplace transform introduced above, we obtain the magnetic field in the time domain:</p>
<p><span class="math display">\[
\begin{align}
\begin{split}
\mathbf h(\mathbf r, t) = &amp; \frac{1}{4 \pi r^3}
\left[
    \frac{\mathbf m \cdot \mathbf r}{r^2}
    \left(3 \, \mathrm{erfc}(\Theta r) + \left(\frac{6}{\sqrt{\pi}}\Theta r + \frac{4}{\sqrt{\pi}}\Theta^3 r^3\right)e^{-\Theta^2 r^2}
    \right) \mathbf r \right. - \\
     &amp;  \left. \left(
    \mathrm{erfc}(\Theta r) + \left(\frac{2}{\sqrt{\pi}}\Theta r + \frac{4}{\sqrt{\pi}}\Theta^3 r^3\right)e^{-\Theta^2 r^2}
    \right) \mathbf m
    \right]
    \end{split}
\end{align}
\]</span></p>
<div id="b397955b" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.special <span class="im">import</span> erf, erfc</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Ht(r, m, t, sigma):</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> np.pi <span class="op">*</span> <span class="fl">4e-7</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> np.linalg.norm(r)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> np.sqrt(mu <span class="op">*</span> sigma <span class="op">/</span> <span class="dv">4</span> <span class="op">/</span> t)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    tr <span class="op">=</span> theta <span class="op">*</span> R</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    t2r2 <span class="op">=</span> tr<span class="op">**</span><span class="dv">2</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    t3r3 <span class="op">=</span> tr<span class="op">**</span><span class="dv">3</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    sqpi <span class="op">=</span> np.sqrt(np.pi)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> (<span class="fl">4.0</span> <span class="op">*</span> np.pi <span class="op">*</span> R<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> alpha <span class="op">*</span> (</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        np.dot(m, r) <span class="op">/</span> R<span class="op">**</span><span class="dv">2</span>  <span class="op">*</span> r</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">3</span> <span class="op">*</span> erfc(tr) <span class="op">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                (<span class="dv">6</span> <span class="op">*</span> tr <span class="op">/</span> sqpi <span class="op">+</span> <span class="dv">4</span> <span class="op">*</span> t3r3 <span class="op">/</span> sqpi) <span class="op">*</span> np.exp(<span class="op">-</span>t2r2)) </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                <span class="op">-</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            (erfc(tr) <span class="op">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                (<span class="dv">4</span> <span class="op">*</span> t3r3 <span class="op">/</span> sqpi <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> tr <span class="op">/</span> sqpi) <span class="op">*</span> np.exp(<span class="op">-</span>t2r2)) </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> m</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> H</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="69a05c5c" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Ht(np.array([<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">0</span>]), np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>]), <span class="fl">1e-0</span>, <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([ 0.00000000e+00,  0.00000000e+00, -7.95774926e-08])</code></pre>
</div>
</div>
<p>However, the time derivative of the magnetic field is important, which is why we differentiate w.r.t. time. Using the chain rule, we obtain</p>
<p><span class="math display">\[
    \partial_t \mathbf h(\mathbf r, t) = \frac{\Theta^3}{\sqrt{\pi}^3 t} \left[
    \Theta^2 r^2
    \frac{\mathbf m \cdot \mathbf r}{r^2}
    \mathbf r -
    (\Theta^2 r ^2 - 1)
    \mathbf m
    \right] e^{-\Theta^2 r^2}.
\]</span></p>
</section>
<section id="numerical-example" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="numerical-example"><span class="header-section-number">8.5</span> Numerical example</h2>
<div id="fb65db12" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dHdt(r, m, t, sigma):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> <span class="fl">4e-7</span> <span class="op">*</span> np.pi</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> np.linalg.norm(r)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> np.sqrt(mu <span class="op">*</span> sigma <span class="op">/</span> <span class="fl">4.0</span> <span class="op">/</span> t)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    tr <span class="op">=</span> theta <span class="op">*</span> R</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    t2r2 <span class="op">=</span> tr<span class="op">**</span><span class="dv">2</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    sqpi <span class="op">=</span> np.sqrt(np.pi)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> theta<span class="op">**</span><span class="dv">3</span> <span class="op">/</span> sqpi<span class="op">**</span><span class="dv">3</span> <span class="op">/</span> t <span class="op">*</span> np.exp(<span class="op">-</span>t2r2) <span class="op">*</span> (</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            t2r2 <span class="op">*</span> np.dot(m, r) <span class="op">*</span> r <span class="op">/</span> R<span class="op">**</span><span class="dv">2</span> <span class="op">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span> <span class="op">-</span> t2r2) <span class="op">*</span> m</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We now simulate the step function and impulse response of the electrically conductive full space.</p>
<p>We choose <span class="math inline">\(\mathbf r = [100, 0, 0]^\top\)</span> as the observation point. The conductivity is 0.01 S/m. The dipole moment is <span class="math inline">\(\mathbf m = [0 ,0 , 1]^\top\)</span>.</p>
<p>We simulate the fields for logarithmically equidistant times in the interval <span class="math inline">\(10^{-7} \le t \le 1\)</span> s.</p>
<p>The simulated quantities are <span class="math inline">\(e_y(t)\)</span>, <span class="math inline">\(h_z(t)\)</span> and <span class="math inline">\(\partial_t h_z(t)\)</span>.</p>
<div id="62d08505" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> np.array([<span class="fl">100.0</span>, <span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> <span class="dv">71</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>tt <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">7</span>, <span class="dv">0</span>, nt, endpoint<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>ey <span class="op">=</span> np.array([Et(r, m, v, sigma)[<span class="dv">1</span>] <span class="cf">for</span> v <span class="kw">in</span> tt])</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>hz <span class="op">=</span> np.array([Ht(r, m, v, sigma)[<span class="dv">2</span>] <span class="cf">for</span> v <span class="kw">in</span> tt])</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>dhzdt <span class="op">=</span> np.array([dHdt(r, m, v, sigma)[<span class="dv">2</span>] <span class="cf">for</span> v <span class="kw">in</span> tt])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The electric field exhibits an asymptotic behaviour of <span class="math inline">\(e \sim t^{-5/2}\)</span> as <span class="math inline">\(t \to \infty\)</span></p>
<div id="cell-fig-ey" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> <span class="kw">lambda</span> t: np.sqrt(np.pi <span class="op">*</span> <span class="fl">4e-7</span> <span class="op">*</span> sigma <span class="op">/</span> <span class="dv">4</span> <span class="op">/</span> t) <span class="op">*</span> np.linalg.norm(r)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>TR <span class="op">=</span> np.array([tr(t) <span class="cf">for</span> t <span class="kw">in</span> tt])</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>iind <span class="op">=</span> np.argwhere(TR <span class="op">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>ax.loglog(tt, np.<span class="bu">abs</span>(ey), linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>ax.loglog(tt, [<span class="dv">2</span> <span class="op">*</span> np.<span class="bu">abs</span>(ey[<span class="op">-</span><span class="dv">1</span>]) <span class="op">*</span> t<span class="op">**</span>(<span class="op">-</span><span class="fl">2.5</span>) <span class="cf">for</span> t <span class="kw">in</span> tt], label<span class="op">=</span><span class="vs">r'asymptotic $\sim t^{-5/2}$'</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>tstar <span class="op">=</span> tt[iind][<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>ax.axvspan(tt[<span class="dv">0</span>], tstar, facecolor<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>ax.axvspan(tstar, tt[<span class="op">-</span><span class="dv">1</span>], facecolor<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"t in s"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$e_y(t)$ in V/m'</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="fl">1e-18</span>, <span class="fl">1e-5</span>))</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r'$e_y(t)$, r = 100 m'</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-ey" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ey-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="timedomain_fullspace_files/figure-html/fig-ey-output-1.png" width="534" height="378" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ey-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: Electric field component <span class="math inline">\(e_y\)</span> due to a step-on vertical magnetic dipole in fullspace. The red and green shading indicates the regime where <span class="math inline">\(\Theta r &gt; 1\)</span> and <span class="math inline">\(\Theta r &lt; 1\)</span>, resp.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The magnetic field approaches a stationary value as <span class="math inline">\(t \to \infty\)</span>.</p>
<p>Obviously, <span class="math display">\[
h(r, t) = -\frac{1}{4 \pi r^3} \text{ for } t \to \infty.
\]</span></p>
<p>The numerical evaluations are identical up to rounding errors.</p>
<div id="ad3b8463" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'h_z(r,t) = '</span> <span class="op">+</span> <span class="bu">str</span>(<span class="op">-</span><span class="fl">1.0</span> <span class="op">/</span> (<span class="dv">4</span> <span class="op">*</span> np.pi <span class="op">*</span> np.linalg.norm(r)<span class="op">**</span><span class="dv">3</span>)))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'hz[-1]   = '</span> <span class="op">+</span> <span class="bu">str</span>(hz[<span class="op">-</span><span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>h_z(r,t) = -7.957747154594767e-08
hz[-1]   = -7.957749262700399e-08</code></pre>
</div>
</div>
<div id="cell-fig-hz" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ax.loglog(tt, np.<span class="bu">abs</span>(hz), linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>ax.axvspan(tt[<span class="dv">0</span>], tstar, facecolor<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ax.axvspan(tstar, tt[<span class="op">-</span><span class="dv">1</span>], facecolor<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"t in s"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$h_z(t)$ in A/m'</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="fl">1e-14</span>, <span class="fl">1e-6</span>))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.legend()</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r'$h_z(t)$'</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-hz" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="timedomain_fullspace_files/figure-html/fig-hz-output-1.png" width="532" height="378" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.2: Magnetic field component <span class="math inline">\(h_z\)</span> due to a current step-on vertical magnetic dipole in fullspace. The red and green shading indicates the regime where <span class="math inline">\(\Theta r &gt; 1\)</span> and <span class="math inline">\(\Theta r &lt; 1\)</span>, resp.
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-dhzdt" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fneg <span class="op">=</span> np.argwhere(dhzdt <span class="op">&lt;</span> <span class="fl">0.0</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fpos <span class="op">=</span> np.argwhere(dhzdt <span class="op">&gt;</span> <span class="fl">0.0</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>ax.loglog(tt[fneg], np.<span class="bu">abs</span>(dhzdt[fneg]), color<span class="op">=</span><span class="st">'C0'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ax.loglog(tt[fpos], np.<span class="bu">abs</span>(dhzdt[fpos]), color<span class="op">=</span><span class="st">'C0'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>ax.loglog(tt, [<span class="dv">2</span> <span class="op">*</span> np.<span class="bu">abs</span>(dhzdt[<span class="op">-</span><span class="dv">1</span>]) <span class="op">*</span> t<span class="op">**</span>(<span class="op">-</span><span class="fl">2.5</span>) <span class="cf">for</span> t <span class="kw">in</span> tt], color<span class="op">=</span><span class="st">'C1'</span>, label<span class="op">=</span><span class="vs">r'asymptotic $\sim t^{-5/2}$'</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>ax.axvspan(tt[<span class="dv">0</span>], tstar, facecolor<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>ax.axvspan(tstar, tt[<span class="op">-</span><span class="dv">1</span>], facecolor<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"t in s"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$\partial_t h_z(t)$ in A/(ms)'</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="fl">1e-14</span>, <span class="fl">1e-2</span>))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r'$\partial_t h_z(t)$'</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-dhzdt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dhzdt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="timedomain_fullspace_files/figure-html/fig-dhzdt-output-1.png" width="532" height="378" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dhzdt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.3: Time derivative of the magnetic field component <span class="math inline">\(h_z\)</span> due to a current step-on vertical magnetic dipole in fullspace. The red and green shading indicates the regime where <span class="math inline">\(\Theta r &gt; 1\)</span> and <span class="math inline">\(\Theta r &lt; 1\)</span>, resp.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="late-time-asymptotic-behaviour-and-apparent-resistivity" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="late-time-asymptotic-behaviour-and-apparent-resistivity"><span class="header-section-number">8.6</span> Late-time asymptotic behaviour and apparent resistivity</h2>
<p>The resistivity of the full space can be reconstructed from the late-time asymptotics of <span class="math inline">\(\partial_t \mathbf h(t)\)</span>.</p>
<p>For <span class="math inline">\(t \to \infty\)</span> the <em>late-time asymptotics</em> is</p>
<p><span class="math display">\[
\partial_t \mathbf h^L(t) = \frac{\Theta^3(t)}{\sqrt{\pi}^3 t} = \frac{1}{8} \left(\frac{\mu\sigma}{\pi}\right)^{3/2} t^{-5/2} \mathbf m.
\]</span></p>
<p>We do not recognize any dependence on the distance <span class="math inline">\(r\)</span>.</p>
<p>From the asymptotic behaviour of the late-time, we can reconstruct the conductivity of the full space directly from the measured variable.</p>
<p>For example, the following applies for <span class="math inline">\(\mathbf m = (0, 0, m)^\top\)</span>:</p>
<p><span class="math display">\[
\sigma = \frac{4 \pi}{\mu} \left( \frac{1}{m} \partial_t h_z(t) \right)^{2/3} t^{5/3}
\]</span></p>
<div id="cell-fig-sigma-from-latetime" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> np.pi <span class="op">*</span> <span class="fl">4e-7</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sig_a <span class="op">=</span> np.array([<span class="dv">4</span> <span class="op">*</span> np.pi <span class="op">/</span> mu0 <span class="op">*</span> np.<span class="bu">abs</span>(u)<span class="op">**</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">*</span> v<span class="op">**</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">3</span>) <span class="cf">for</span> u, v <span class="kw">in</span> <span class="bu">zip</span>(dhzdt, tt)])</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ax.loglog(tt, sig_a)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ax.axvspan(tt[<span class="dv">0</span>], tstar, facecolor<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>ax.axvspan(tstar, tt[<span class="op">-</span><span class="dv">1</span>], facecolor<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>ax.hlines(sigma, tt[<span class="dv">0</span>], tt[<span class="op">-</span><span class="dv">1</span>], linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'C1'</span>, label<span class="op">=</span><span class="st">'True conductivity'</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="fl">1e-5</span>, <span class="fl">1e-1</span>))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'t in s'</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$\sigma_a~in~S/m$'</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-sigma-from-latetime" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sigma-from-latetime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="timedomain_fullspace_files/figure-html/fig-sigma-from-latetime-output-1.png" width="526" height="362" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sigma-from-latetime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.4: Apparent conductivity evaluated from the late-time asymptotics. The red and green shading indicates the regime where <span class="math inline">\(\Theta r &gt; 1\)</span> and <span class="math inline">\(\Theta r &lt; 1\)</span>, resp.
</figcaption>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./potentials.html" class="pagination-link" aria-label="Sources in unbounded media">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sources in unbounded media</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./halfspace.html" class="pagination-link" aria-label="Dipole sources above a uniform halfspace">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dipole sources above a uniform halfspace</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>