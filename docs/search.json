[
  {
    "objectID": "pde.html",
    "href": "pde.html",
    "title": "5  Partial Differential Equations",
    "section": "",
    "text": "5.1 The curl-curl equation\nWe first eliminate one field from the set of Maxwell’s equations by applying the curl operator (\\(\\nabla \\times\\)) to one of the equations, i.e., Faraday’s law.\nThis results in a second-order PDE because we differentiate twice with respect to spatial coordinates.\nFinally, we obtain the curl-curl equation for the electric field \\(\\mathbf e\\) as \\[\n\\nabla \\times \\nabla \\times \\mathbf e  +\\mu \\sigma \\partial_t \\mathbf e + \\mu \\varepsilon \\partial^2_{tt} \\mathbf e = \\mathbf 0.\n\\tag{5.1}\\]\nThis is a second-order PDE with first- and second-order time derivatives.\nNote that you obtain a similar PDE for the magnetic field \\(\\mathbf h\\) if you apply the steps outlined above to Ampere’s law.\nOften, a slightly different form of 5.1 is used.\nThe following identity is useful for any vector field \\(\\mathbf f\\): \\[\n\\nabla \\times \\nabla \\times \\mathbf f = \\nabla \\nabla \\cdot \\mathbf f - \\nabla^2 \\mathbf f\n\\tag{5.2}\\]\nThis equation is useful, e.g., when \\(\\nabla \\cdot \\mathbf f = 0\\). In this case the curl-curl operator can be replaced by \\(-\\nabla^2\\), the vector Laplace operator defined over a vector field.\nUnder which conditions can we switch from the curl-curl to the Laplace operator? Clearly, the term \\(\\nabla \\nabla \\cdot \\mathbf f\\) must vanish (or its contribution must be negligible).",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Partial Differential Equations</span>"
    ]
  },
  {
    "objectID": "pde.html#the-curl-curl-equation",
    "href": "pde.html#the-curl-curl-equation",
    "title": "5  Partial Differential Equations",
    "section": "",
    "text": "Tip\n\n\n\n\n\n\\[\n\\begin{align}\n\\nabla \\times \\mathbf e  & = -\\partial_t \\mathbf b \\\\\n\\nabla \\times \\nabla \\times \\mathbf e & = \\nabla \\times (-\\partial_t \\mathbf b) \\\\\n  & = -\\nabla \\times (\\partial_t \\mathbf b) \\\\\n  & = -\\partial_t\\nabla \\times  \\mathbf b \\\\\n  & = -\\partial_t\\nabla \\times ( \\mu \\mathbf h) \\\\\n  & = -\\partial_t \\mu \\nabla \\times \\mathbf h \\\\\n  & = -\\mu \\partial_t \\nabla \\times \\mathbf h \\\\\n  & = -\\mu \\partial_t (\\mathbf j + \\partial_t \\mathbf d) \\\\\n  & = -\\mu \\partial_t (\\sigma \\mathbf e + \\partial_t \\mathbf d) \\\\\n  & -\\mu \\partial_t (\\sigma \\mathbf e + \\partial_t \\varepsilon \\mathbf e) \\\\\n  & = -\\mu \\partial_t \\sigma \\mathbf e -\\mu \\partial^2_{tt} \\varepsilon \\mathbf e \\\\\n  & = -\\mu \\sigma \\partial_t \\mathbf e -\\mu \\varepsilon \\partial^2_{tt} \\mathbf e\n\\end{align}\n\\]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWarning\n\n\n\nThe vector Laplacian is similar to the scalar Laplacian. The scalar Laplacian applies to a scalar field and returns a scalar quantity, whereas the vector Laplacian applies to a vector field and returns a vector quantity.\nIn Cartesian coordinates, the returned vector field is equal to the vector field of the scalar Laplacian applied to each vector component.\n\n\n\n\n5.1.1 Decay of free charges\nWhen the electric field \\(\\mathbf e\\) is considered, we are faced with the following problem: Under which conditions \\(\\nabla \\cdot \\mathbf e\\) becomes negligible small?\nThe answer should be clear: When there are no free charges present in the considered domain, there is no associated electric field.\nRecall, that in a uniform dielectric medium there holds Gauß’ s law for electric charges\n\\[\n\\nabla \\cdot \\mathbf e = \\frac{\\rho_E}{\\varepsilon},\n\\]\nwhere \\(\\rho_E\\) is the volume charge density and \\(\\varepsilon = \\varepsilon_r \\varepsilon_0\\) is the permittivity.\nLet’s find out how to solve the problem.\nWe want to show that \\(\\nabla \\cdot \\mathbf e \\approx 0\\) for some time \\(t&gt;0\\). As long as \\(t \\le 0\\), there is a certain charge density \\(\\rho_E(t)\\) concentrated at, e.g., the origin of a uniform fullspace.\nWe apply the divergence operator to Ampere’s law:\n\\[\n\\begin{align}\n\\nabla \\cdot \\nabla \\times \\mathbf h & = \\nabla \\cdot \\mathbf j + \\partial_t \\nabla \\cdot \\mathbf d \\\\\n& = 0\n\\end{align}\n\\]\nWith \\[\n\\nabla \\cdot \\mathbf d = \\rho_E \\\\\n\\nabla \\cdot \\mathbf j = \\nabla \\cdot (\\sigma \\mathbf e) = \\nabla\\sigma \\cdot \\mathbf e + \\sigma \\nabla \\cdot \\mathbf e \\\\\n\\sigma \\nabla \\cdot \\mathbf e = \\sigma \\frac{\\rho_E}{\\varepsilon}\n\\] we obtain an initial-value problem for the charge density\n\\[\n\\frac{\\sigma}{\\varepsilon} \\rho_E + \\dot{\\rho_E} = 0.\n\\]\nIts solution is\n\\[\n\\rho_E(t) = \\rho_E(0) \\exp\\left({-\\frac{\\sigma}{\\varepsilon}t}\\right).\n\\tag{5.3}\\]\n\n5.1.1.1 Numerical experiment\nTo study the decay of a free charge denoted by an electrical charge density, we define as initial condition for \\(t=0\\) that \\(\\rho_E(0) = 1~A\\cdot s\\cdot m^{-3}\\) .\nFurther, the conductivity of the uniform fullspace is 0.01 S/m.\nWe plot the function 5.3 for a very small time window:\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nsigma_n = 0.01\nepsilon_n = 8.854e-12\n\ndef rho(t):\n  return np.exp(-sigma_n/epsilon_n * t)\n\nt_n = np.logspace(-13, -7, num=71, endpoint=True)\n\nplt.semilogx(t_n, rho(t_n))\nplt.xlabel('t in s')\nplt.ylabel(r'$\\rho_E(t)/\\rho_E(0)$')\nplt.show()\n\n\n\n\n\n\n\n\n\nBy visual inspection, after approx. 10 ns the volume charge density has dropped to zero.\nLet’s be more precise:\nWe can calculate the time at which the charge density decays to a given fraction of its initial value, e.g., to 1 ppm.\n\nfrom sympy import *\n\nt, sigma, epsilon, rho0 = symbols('t sigma epsilon rho_0', real=True)\nrhoE = symbols('rho_E')\n\nexpr = rhoE - rho0 * exp(-sigma / epsilon * t)\n\ntt = solve(expr, t)\ntt[0]\n\n\\(\\displaystyle \\frac{\\epsilon \\log{\\left(\\frac{\\rho_{0}}{\\rho_{E}} \\right)}}{\\sigma}\\)\n\n\nWe find that the time \\(t\\) at which a certain fraction of the initial charge density is obtained, can be calculated using\n\\[\n\\hat{t} = \\frac{\\epsilon }{\\sigma}\\log{\\left(\\frac{\\rho_{0}}{\\rho_{E}} \\right)} = -\\frac{\\epsilon }{\\sigma}\\log{\\left(\\frac{\\rho_{E}}{\\rho_{0}} \\right)}\n\\]\n\ntstar = -epsilon_n / sigma_n * np.log(1e-6)\n\nWith the values given above, the charge density drops to 1 ppm of its initial value after 1.22e-08 seconds.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Partial Differential Equations</span>"
    ]
  },
  {
    "objectID": "pde.html#the-telegraph-equation",
    "href": "pde.html#the-telegraph-equation",
    "title": "5  Partial Differential Equations",
    "section": "5.2 The Telegraph equation",
    "text": "5.2 The Telegraph equation\nBy virtue of 5.2 we can cast the curl-curl equation 5.1 into the telegraph equation of induction, such that\n\\[\n-\\nabla^2 \\mathbf e + \\mu \\sigma \\partial_t \\mathbf e + \\mu \\varepsilon \\partial^2_{tt} \\mathbf e = \\mathbf 0.\n\\tag{5.4}\\]\n\n\n\n\n\n\nNote\n\n\n\nNote that the same PDE can be derived for the magnetic field!\n\n\nEq. 5.4 and 5.1 are second-order linear PDEs with at most second-order time derivatives. Hence, they describe wave phenomena.\n\n\n\n\n\n\nNote\n\n\n\nA second-order, linear, constant-coefficient PDE for \\(u\\) takes the general form\n\\[\nA u_{xx} + 2 B u_{xy} + C u_{yy} + D u_x + E u_y + F u + G = 0\n\\]\nThis PDE is classified as being\n\nparabolic, when \\(B^2 - AC = 0\\)\nhyperbolic, when \\(B^2 - AC &gt; 0\\)\nelliptic, when \\(B^2 - AC &lt; 0\\).\n\nIn our case, \\(x\\) plays the role of any spatial variable, and \\(t\\) plays the role of \\(y\\).\nHence, for 5.4, \\(A=-1\\), \\(E=\\mu\\sigma\\), \\(C=\\mu\\varepsilon\\), and the remaining coefficients are zero.\nChecks:\n\\(B^2 - AC = 0 - (-1 \\cdot \\mu\\varepsilon) &gt; 0\\) \\(\\to\\) PDE is hyperbolic.\n\\(B^2 - AC = 0 - (-1 \\cdot 0) = 0\\) \\(\\to\\) PDE is parabolic\nFor the elliptic PDE there are no time derivatives, we can therefore let \\(x\\) and \\(y\\) take their roles as Cartesian coordinates.\nSo, with \\(A = C = -1\\),\n\\(B^2 - AC = 0 - (-1 \\cdot -1) &lt; 0\\) \\(\\to\\) PDE is elliptic.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Partial Differential Equations</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html",
    "href": "Differential_Operators_Sympy.html",
    "title": "6  Differential operators using sympy",
    "section": "",
    "text": "6.1 Gradient\n\\[\n\\nabla f\n\\]",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html#divergence",
    "href": "Differential_Operators_Sympy.html#divergence",
    "title": "6  Differential operators using sympy",
    "section": "6.2 Divergence",
    "text": "6.2 Divergence\n\\[\n\\nabla \\cdot \\mathbf F\n\\]",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html#curl",
    "href": "Differential_Operators_Sympy.html#curl",
    "title": "6  Differential operators using sympy",
    "section": "6.3 Curl",
    "text": "6.3 Curl\n\\[\n\\nabla \\times \\mathbf F\n\\]\n\ndef nabla(f, x, y, z):\n    return Matrix([f.diff(x), f.diff(y), f.diff(z)])\n\ndef nabla_v(f, x, y, z,  v):\n    return nabla(f, x, y, z).dot(v)\n\ndef gradient_op(f, *variables):\n    \"\"\"Return the vector gradient of a scalar function.\"\"\"\n    return Matrix([f.diff(v) for v in variables ])\n\ndef divergence_op(vec_F, *vars):\n    \"\"\"Return the scalar divergence of a vector field.\"\"\"\n    return sum( Matrix( [ vec_F[i].diff(v) for i,v in enumerate(vars)]) )\n\ndef curl_part(vec_F, u, v, *vars):\n    return vec_F[v].diff(vars[u]) - vec_F[u].diff(vars[v])\n    \ndef curl_op(vec_F, *vars):\n    \"\"\"Return the curl of a vector field.\"\"\"\n    return Matrix([curl_part(vec_F, u, v, *vars) for u, v in [(1,2), (2,0), (0,1)]])\n\n\nx, y, z = symbols('x y z', real=True)\n\nCompute the gradient of \\[\nf = \\frac{1}{r},\n\\] where \\(r = \\sqrt{x^2 + y^2 + z^2}\\).\n\nr = sqrt(x**2 + y**2 + z**2)\n\n\na, b, c = symbols('a b c', real=True)\nV = a * x + b * y + c * z\ngradient_op(V, x, y, z)\n\n\\(\\displaystyle \\left[\\begin{matrix}a\\\\b\\\\c\\end{matrix}\\right]\\)\n\n\n\ng = gradient_op(1 / r, x, y, z) #subs(sqrt(x**2 + y**2 + z**2), r)\n\n\ndivergence_op(g, x, y, z)\n\n\\(\\displaystyle \\frac{3 x^{2}}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{5}{2}}} + \\frac{3 y^{2}}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{5}{2}}} + \\frac{3 z^{2}}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{5}{2}}} - \\frac{3}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{3}{2}}}\\)\n\n\n\ncurl_op(g, x, y, z)\n\n\\(\\displaystyle \\left[\\begin{matrix}0\\\\0\\\\0\\end{matrix}\\right]\\)",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html#curl-formula",
    "href": "Differential_Operators_Sympy.html#curl-formula",
    "title": "6  Differential operators using sympy",
    "section": "6.4 Curl formula",
    "text": "6.4 Curl formula\n\nP, Q, R = [Function(ch, real = True)(x, y, z) for ch in ['P', 'Q', 'R']]\nP, Q, R\n\n(P(x, y, z), Q(x, y, z), R(x, y, z))\n\n\n\ncurl_op(Matrix([P, Q, R]), x, y, z)\n\n\\(\\displaystyle \\left[\\begin{matrix}- \\frac{\\partial}{\\partial z} Q{\\left(x,y,z \\right)} + \\frac{\\partial}{\\partial y} R{\\left(x,y,z \\right)}\\\\\\frac{\\partial}{\\partial z} P{\\left(x,y,z \\right)} - \\frac{\\partial}{\\partial x} R{\\left(x,y,z \\right)}\\\\- \\frac{\\partial}{\\partial y} P{\\left(x,y,z \\right)} + \\frac{\\partial}{\\partial x} Q{\\left(x,y,z \\right)}\\end{matrix}\\right]\\)",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html#divergence-formula",
    "href": "Differential_Operators_Sympy.html#divergence-formula",
    "title": "6  Differential operators using sympy",
    "section": "6.5 Divergence formula",
    "text": "6.5 Divergence formula\n\ndivergence_op(Matrix([P, Q, R]), x, y, z)\n\n\\(\\displaystyle \\frac{\\partial}{\\partial x} P{\\left(x,y,z \\right)} + \\frac{\\partial}{\\partial y} Q{\\left(x,y,z \\right)} + \\frac{\\partial}{\\partial z} R{\\left(x,y,z \\right)}\\)",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "semisphere.html",
    "href": "semisphere.html",
    "title": "7  Potential of a point source in a semi-sphere embedded in a uniform halfspace",
    "section": "",
    "text": "7.1 Verification\nLet’s check that the potential and the current density are actually continuous at \\(r=a\\).\nWe first form the respective expressions for \\(r=a\\) and check if the results vanish.\nD = U1.subs(r,a) - U2.subs(r,a)\nD\n\n\\(\\displaystyle \\frac{I \\rho_{1}}{2 \\pi a} - \\frac{I \\rho_{2}}{2 \\pi a} + \\frac{I \\left(- \\rho_{1} + \\rho_{2}\\right)}{2 \\pi a}\\)\nD.simplify()\n\n\\(\\displaystyle 0\\)\nThis result can be obtained directly by using the expression ex1 for the continuity of the potential:\nex1.subs(r, a).subs(A, A_).subs(B, B_).simplify()\n\n\\(\\displaystyle 0\\)\nIn ex2 we have used the condition for continuity of the radial component of the current densities:\nex2.subs(r, a).subs(B, B_)\n\n\\(\\displaystyle 0\\)\nBoth results indicate that the conditions of continuity are fullfilled.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Potential of a point source in a semi-sphere embedded in a uniform halfspace</span>"
    ]
  },
  {
    "objectID": "semisphere.html#visualization-of-the-result",
    "href": "semisphere.html#visualization-of-the-result",
    "title": "7  Potential of a point source in a semi-sphere embedded in a uniform halfspace",
    "section": "7.2 Visualization of the result",
    "text": "7.2 Visualization of the result\n\nimport matplotlib.pyplot as plt\n\n\nrho1_n = 100.0\nrho2_n = 1000.0\na_n = 3.0\n\n\nU1_f = lambdify([rho1, rho2, r, a, I], U1)\nU2_f = lambdify([rho1, rho2, r, a, I], U2)\n\n\nR1 = np.arange(1.0, a_n + .01, 0.1)\nR2 = np.arange(a_n, 10.0, 0.1)\n\n\nplt.plot(R1, [U1_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R1])\nplt.plot(R2, [U2_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R2])\nplt.title(\"Electric Potential\")\nplt.xlabel(\"r\")\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\nE1_f = lambdify([rho1, rho2, r, a, I], -diff(U1, r))\nE2_f = lambdify([rho1, rho2, r, a, I], -diff(U2, r))\n\nj1_f = lambdify([rho1, rho2, r, a, I], -diff(U1, r) / rho1)\nj2_f = lambdify([rho1, rho2, r, a, I], -diff(U2, r) / rho2)\n\n\nplt.plot(R1, [j1_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R1])\nplt.plot(R2, [j2_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R2])\nplt.title(\"Current density\")\nplt.xlabel(\"r\")\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\nplt.plot(R1, [E1_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R1])\nplt.plot(R2, [E2_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R2])\nplt.title(\"Electric Field\")\nplt.xlabel(\"r\")\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nThe value of a a is {eval}a_n",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Potential of a point source in a semi-sphere embedded in a uniform halfspace</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "8  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.",
    "crumbs": [
      "Summary",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Summary</span>"
    ]
  }
]