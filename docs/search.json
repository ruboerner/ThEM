[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Theory of Electromagnetic Methods",
    "section": "",
    "text": "Prerequisites\nThese are the lecture notes for the 2024 module on Theory of Electromagnetic Methods for students of Geophysics in the Masters course at the Institute of Geophysics and Geoinformatics, TU Bergakademie Freiberg.\nAll materials are stored in the GitHub repo https://github.com/ruboerner/ThEM.\nHave fun!",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "preface.html",
    "href": "preface.html",
    "title": "1  Preface",
    "section": "",
    "text": "Links: - Maxwell",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "2  Electromagnetic fields",
    "section": "",
    "text": "2.1 Material properties\nIn electromagnetics we have the following material properties:\nIn the context of geo-electromagnetics, these parameters are associated with particular rock properties which are studied in petrophysics.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Electromagnetic fields</span>"
    ]
  },
  {
    "objectID": "intro.html#material-properties",
    "href": "intro.html#material-properties",
    "title": "2  Electromagnetic fields",
    "section": "",
    "text": "electrical conductivity \\(\\sigma\\)\ndielectrical permittivity \\(\\varepsilon\\)\nmagnetic permeability \\(\\mu\\).",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Electromagnetic fields</span>"
    ]
  },
  {
    "objectID": "intro.html#simplifications",
    "href": "intro.html#simplifications",
    "title": "2  Electromagnetic fields",
    "section": "2.2 Simplifications",
    "text": "2.2 Simplifications\nAs we know from theroretical physics, the relations between the fields and the associated parameters are very general and allow, e.g., strong frequency-dependency or non-linearities.\nIn geo-electromagnetics, however, we can allow for a few simplifications.\nAll rock parameters are supposed to be\n\nlinear with respect to the fields\nstationary, and\nisotropic.\n\nWe will see later that anisotropy is a quite general rock property which needs to be considered in the interpretation of geo-electromagnetic field data.\nMoreover, we will first study the general properties of the EM induction in a uniform full-space by neglecting any spatial inhomogeneities of the parameters.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Electromagnetic fields</span>"
    ]
  },
  {
    "objectID": "fourier.html",
    "href": "fourier.html",
    "title": "3  Fourier transform",
    "section": "",
    "text": "3.1 Example\nIn this example we use a Fourier series expansion to approximate the periodic square function \\(u(x)\\) of length \\(2L\\).\nAn analytic formula for a square wave with unit amplitude and period \\(2L\\) is given by \\(u(x) = \\mathrm{sign}(\\sin(\\frac{\\pi x}{L})\\).\nShow the code\nx = np.arange(0, 4, 0.001)\nu = [np.sign(np.sin(np.pi * v / 2)) for v in x]\nfig, ax = plt.subplots(figsize=(4, 3))\nax.plot(x, u)\nax.fill_between(x, u, np.zeros_like(u), alpha=0.3)\nax.set_xlabel('x')\nax.set_ylabel('u(x)')\nax.set_title('Square wave')\nax.set_aspect('equal')\nax.grid(True)\nThe Fourier series expansion for a periodic square wave \\(u(x)\\) is\n\\[\nu(x) = \\lim_{N \\to \\infty} \\frac{4}{\\pi} \\sum_{n=1,3,5, \\ldots}^{N} \\frac{1}{n} \\sin \\left(\\frac{n \\pi x}{L}\\right).\n\\]\nA change of the running index \\(n\\) yields a representation which is better suited for numerical implementation:\n\\[\nu(x) = \\lim_{N \\to \\infty} \\frac{4}{\\pi} \\sum_{k=1}^{N} \\frac{1}{2k-1} \\sin \\left(\\frac{(2k-1) \\pi x}{L}\\right).\n\\]\nIn theory, the sequence of summations is infinite, whereas in general we deal with a truncated series, i.e., \\(N \\ll \\infty\\).",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Fourier transform</span>"
    ]
  },
  {
    "objectID": "fourier.html#example",
    "href": "fourier.html#example",
    "title": "3  Fourier transform",
    "section": "",
    "text": "3.1.1 Implementation\nFirst we write a Python function which calculates the individual sine terms\n\\[\nu_k(x) =  \\frac{1}{2k-1} \\sin \\left(\\frac{(2k-1) \\pi x}{L}\\right)\n\\]\nThis function is called uk and takes the arguments x and the index k. The window length L takes the default setting of 0.5.\n\n\nShow the code\ndef uk(x, k, L=0.5):\n    return np.sin(np.pi * (2 * k - 1) * x / L) / (2 * k - 1)\n\n\nNext, we implement the summation over all \\(k\\) sine terms, i.e., \\[\nu(x) \\approx \\frac{4}{\\pi} \\sum_{k=1}^N u_k(x)\n\\]\n\n\nShow the code\ndef u(x, k, L):\n    value = 4 / np.pi * \\\n        sum(uk(x, i, L) for i in range(1, k+1)) if k &gt; 0 else np.zeros_like(x)\n    return value\n\n\n\n\nShow the code\nL = 2\norder = 4\nx = np.arange(0, 2*L, 0.001)\nu_n = [np.sign(np.sin(np.pi * v / L)) for v in x]\nfig, ax = plt.subplots(nrows=2, ncols=1, sharex=True, layout='constrained')\nax[0].plot(x, u(x, order, L))\nax[0].fill_between(x, u_n, np.zeros_like(u_n), alpha=0.3)\n#ax[0].set_xlabel('x')\nax[0].set_ylabel('u(x)')\nax[0].set_title(f'Fourier series expansion for order={order}')\nax[0].set_aspect('equal')\nax[0].grid(True)\n\norder = 42\nax[1].plot(x, u(x, order, L))\nax[1].fill_between(x, u_n, np.zeros_like(u_n), alpha=0.3)\nax[1].set_xlabel('x')\nax[1].set_ylabel('u(x)')\nax[1].set_title(f'Fourier series expansion for order={order}')\nax[1].set_aspect('equal')\nax[1].grid(True);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nNote the Gibbs phenomenon at the jumps of the square wave. This is a typical behaviour of a piecewise differentiable continuous periodic function. As the expansion order gets large, the overshoot does not die out, but approaches a finite limit.\nIt can be shown that, for sufficiently large \\(N\\), the full overshooting is around 17.9 % larger than the jump in the original function.",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Fourier transform</span>"
    ]
  },
  {
    "objectID": "maxwell.html",
    "href": "maxwell.html",
    "title": "4  Maxwell’s Equations",
    "section": "",
    "text": "4.1 Constitutive equations\nThe goal is to couple these equations. This can be achieved with the use of the constitutive equations, which are\n\\[\n\\begin{align}\n\\mathbf d & = \\varepsilon \\mathbf e \\\\\n\\mathbf b & = \\mu \\mathbf h\n\\end{align}\n\\tag{4.2}\\]\nGenerally, the linear parameters \\(\\varepsilon, \\mu\\) are rank-2 tensors represented as 3-by-3 matrices.",
    "crumbs": [
      "Maxwell's equations",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Maxwell's Equations</span>"
    ]
  },
  {
    "objectID": "maxwell.html#ohms-law",
    "href": "maxwell.html#ohms-law",
    "title": "4  Maxwell’s Equations",
    "section": "4.2 Ohm’s law",
    "text": "4.2 Ohm’s law\nIn an electrically conductive medium, any electric field gives rise to an electric current. This current is expressed by its current density as\n\\[\n\\mathbf j = \\sigma \\mathbf e,\n\\tag{4.3}\\]\nwhere \\(\\sigma\\) is a rank-2 tensor.\nThis tensor can be represented in matrix form as\n\\[\n\\sigma =   \\begin{pmatrix}    \\sigma_{11} & \\sigma_{12} & \\sigma_{13} \\\\    \\sigma_{21} & \\sigma_{22} & \\sigma_{23} \\\\    \\sigma_{31} & \\sigma_{32} & \\sigma_{33}   \\end{pmatrix}.\n\\]\nTensors like introduced here cause anisotropy, i.e., the material properties have different values across different spatial directions.\nA typical observation would be the deviation of the induced current density from the direction of the driving electric field.\n\n4.2.1 Remarks about anisotropy\nThe rank-2 tensor of electrical conductivity \\(\\tilde\\sigma\\) may be represented in matrix form as\n\\[\n  \\hat\\sigma =\n  \\begin{pmatrix}\n    \\sigma_{11} & \\sigma_{12} & \\sigma_{13} \\\\\n    \\sigma_{21} & \\sigma_{22} & \\sigma_{23} \\\\\n    \\sigma_{31} & \\sigma_{32} & \\sigma_{33}\n  \\end{pmatrix}.\n\\]\nAny real symmetric (n-by-n) matrix \\(A\\) can be diagonalized (principal axis theorem), such that\n\\[\nD_A = S^\\top A S  \n\\]\nis a diagonal matrix, and \\(S\\) is an orthogonal matrix.\nInterpreting the matrix \\(A\\) as a linear map in \\(\\mathbb {R} ^3\\), then the matrix \\(S\\) can be thought of as a transformation to the new basis. Between the old and new coordinates there is the relation \\(\\mathbf {x}=S \\boldsymbol {\\xi }\\). The action of the matrix \\(A\\) in the new coordinate system is taken over by the diagonal matrix \\(D_{A}\\).\nAfter transformation of the tensor in diagonal form, we have \\[\n  \\tilde\\sigma =\n  \\begin{pmatrix}\n    \\sigma_{xx} & 0 & 0 \\\\\n    0 & \\sigma_{yy} & 0 \\\\\n    0 & 0 & \\sigma_{zz}\n  \\end{pmatrix}.\n\\]\nIf \\(\\sigma_{xx} = \\sigma_{yy} = \\sigma_{zz} = \\sigma\\), then \\[\n  \\tilde\\sigma = \\sigma\n  \\begin{pmatrix}\n    1 & 0 & 0 \\\\\n    0 & 1 & 0 \\\\\n    0 & 0 & 1\n  \\end{pmatrix} = \\sigma.\n\\] In this case, the conductivity does not depend on the spatial direction and hence is labelled isotropic.",
    "crumbs": [
      "Maxwell's equations",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Maxwell's Equations</span>"
    ]
  },
  {
    "objectID": "pde.html",
    "href": "pde.html",
    "title": "5  Partial Differential Equations",
    "section": "",
    "text": "5.1 The curl-curl equation\nWe first eliminate one field from the set of Maxwell’s equations by applying the curl operator (\\(\\nabla \\times\\)) to one of the equations, i.e., Faraday’s law.\nThis results in a second-order PDE because we differentiate twice with respect to spatial coordinates.\nFinally, we obtain the curl-curl equation for the electric field \\(\\mathbf e\\) as \\[\n\\nabla \\times \\nabla \\times \\mathbf e  +\\mu \\sigma \\partial_t \\mathbf e + \\mu \\varepsilon \\partial^2_{tt} \\mathbf e = \\mathbf 0.\n\\tag{5.1}\\]\nThis is a second-order PDE with first- and second-order time derivatives.\nNote that you obtain a similar PDE for the magnetic field \\(\\mathbf h\\) if you apply the steps outlined above to Ampere’s law.\nOften, a slightly different form of 5.1 is used.\nThe following identity is useful for any vector field \\(\\mathbf f\\): \\[\n\\nabla \\times \\nabla \\times \\mathbf f = \\nabla \\nabla \\cdot \\mathbf f - \\nabla^2 \\mathbf f\n\\tag{5.2}\\]\nThis equation is useful, e.g., when \\(\\nabla \\cdot \\mathbf f = 0\\). In this case the curl-curl operator can be replaced by \\(-\\nabla^2\\), the vector Laplace operator defined over a vector field.\nUnder which conditions can we switch from the curl-curl to the Laplace operator? Clearly, the term \\(\\nabla \\nabla \\cdot \\mathbf f\\) must vanish (or its contribution must be negligible).",
    "crumbs": [
      "Maxwell's equations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Partial Differential Equations</span>"
    ]
  },
  {
    "objectID": "pde.html#the-curl-curl-equation",
    "href": "pde.html#the-curl-curl-equation",
    "title": "5  Partial Differential Equations",
    "section": "",
    "text": "Tip\n\n\n\n\n\n\\[\n\\begin{align}\n\\nabla \\times \\mathbf e  & = -\\partial_t \\mathbf b \\\\\n\\nabla \\times \\nabla \\times \\mathbf e & = \\nabla \\times (-\\partial_t \\mathbf b) \\\\\n  & = -\\nabla \\times (\\partial_t \\mathbf b) \\\\\n  & = -\\partial_t\\nabla \\times  \\mathbf b \\\\\n  & = -\\partial_t\\nabla \\times ( \\mu \\mathbf h) \\\\\n  & = -\\partial_t \\mu \\nabla \\times \\mathbf h \\\\\n  & = -\\mu \\partial_t \\nabla \\times \\mathbf h \\\\\n  & = -\\mu \\partial_t (\\mathbf j + \\partial_t \\mathbf d) \\\\\n  & = -\\mu \\partial_t (\\sigma \\mathbf e + \\partial_t \\mathbf d) \\\\\n  & -\\mu \\partial_t (\\sigma \\mathbf e + \\partial_t \\varepsilon \\mathbf e) \\\\\n  & = -\\mu \\partial_t \\sigma \\mathbf e -\\mu \\partial^2_{tt} \\varepsilon \\mathbf e \\\\\n  & = -\\mu \\sigma \\partial_t \\mathbf e -\\mu \\varepsilon \\partial^2_{tt} \\mathbf e\n\\end{align}\n\\]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWarning\n\n\n\nThe vector Laplacian is similar to the scalar Laplacian. The scalar Laplacian applies to a scalar field and returns a scalar quantity, whereas the vector Laplacian applies to a vector field and returns a vector quantity.\nIn Cartesian coordinates, the returned vector field is equal to the vector field of the scalar Laplacian applied to each vector component.\n\n\n\n\n5.1.1 Decay of free charges\nWhen the electric field \\(\\mathbf e\\) is considered, we are faced with the following problem: Under which conditions \\(\\nabla \\cdot \\mathbf e\\) becomes negligible small?\nThe answer should be clear: When there are no free charges present in the considered domain, there is no associated electric field.\nRecall, that in a uniform dielectric medium there holds Gauß’ s law for electric charges\n\\[\n\\nabla \\cdot \\mathbf e = \\frac{\\rho_E}{\\varepsilon},\n\\]\nwhere \\(\\rho_E\\) is the volume charge density and \\(\\varepsilon = \\varepsilon_r \\varepsilon_0\\) is the permittivity.\nLet’s find out how to solve the problem.\nWe want to show that \\(\\nabla \\cdot \\mathbf e \\approx 0\\) for some time \\(t&gt;0\\). As long as \\(t \\le 0\\), there is a certain charge density \\(\\rho_E(t)\\) concentrated at, e.g., the origin of a uniform fullspace.\nWe apply the divergence operator to Ampere’s law:\n\\[\n\\begin{align}\n\\nabla \\cdot \\nabla \\times \\mathbf h & = \\nabla \\cdot \\mathbf j + \\partial_t \\nabla \\cdot \\mathbf d \\\\\n& = 0\n\\end{align}\n\\]\nWith \\[\n\\nabla \\cdot \\mathbf d = \\rho_E \\\\\n\\nabla \\cdot \\mathbf j = \\nabla \\cdot (\\sigma \\mathbf e) = \\nabla\\sigma \\cdot \\mathbf e + \\sigma \\nabla \\cdot \\mathbf e \\\\\n\\sigma \\nabla \\cdot \\mathbf e = \\sigma \\frac{\\rho_E}{\\varepsilon}\n\\] we obtain an initial-value problem for the charge density\n\\[\n\\frac{\\sigma}{\\varepsilon} \\rho_E + \\dot{\\rho_E} = 0.\n\\]\nIts solution is\n\\[\n\\rho_E(t) = \\rho_E(0) \\exp\\left({-\\frac{\\sigma}{\\varepsilon}t}\\right).\n\\tag{5.3}\\]\n\n5.1.1.1 Numerical experiment\nTo study the decay of a free charge denoted by an electrical charge density, we define as initial condition for \\(t=0\\) that \\(\\rho_E(0) = 1~A\\cdot s\\cdot m^{-3}\\) .\nFurther, the conductivity of the uniform fullspace is 0.01 S/m.\nWe plot the function 5.3 for a very small time window:\n\n\nShow the code\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nsigma_n = 0.01\nepsilon_n = 8.854e-12\n\ndef rho(t):\n  return np.exp(-sigma_n/epsilon_n * t)\n\nt_n = np.logspace(-13, -7, num=71, endpoint=True)\n\nplt.semilogx(t_n, rho(t_n))\nplt.xlabel('t in s')\nplt.ylabel(r'$\\rho_E(t)/\\rho_E(0)$')\nplt.show()\n\n\n\n\n\n\n\n\n\nBy visual inspection, after approx. 10 ns the volume charge density has dropped to zero.\nLet’s be more precise:\nWe can calculate the time at which the charge density decays to a given fraction of its initial value, e.g., to 1 ppm.\n\n\nShow the code\nfrom sympy import *\n\nt, sigma, epsilon, rho0 = symbols('t sigma epsilon rho_0', real=True)\nrhoE = symbols('rho_E')\n\nexpr = rhoE - rho0 * exp(-sigma / epsilon * t)\n\ntt = solve(expr, t)\ntt[0]\n\n\n\\(\\displaystyle \\frac{\\epsilon \\log{\\left(\\frac{\\rho_{0}}{\\rho_{E}} \\right)}}{\\sigma}\\)\n\n\nWe find that the time \\(t\\) at which a certain fraction of the initial charge density is obtained, can be calculated using\n\\[\n\\hat{t} = \\frac{\\epsilon }{\\sigma}\\log{\\left(\\frac{\\rho_{0}}{\\rho_{E}} \\right)} = -\\frac{\\epsilon }{\\sigma}\\log{\\left(\\frac{\\rho_{E}}{\\rho_{0}} \\right)}\n\\]\n\n\nShow the code\ntstar = -epsilon_n / sigma_n * np.log(1e-6)\n\n\nWith the values given above, the charge density drops to 1 ppm of its initial value after 1.22e-08 seconds.",
    "crumbs": [
      "Maxwell's equations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Partial Differential Equations</span>"
    ]
  },
  {
    "objectID": "pde.html#the-telegraph-equation",
    "href": "pde.html#the-telegraph-equation",
    "title": "5  Partial Differential Equations",
    "section": "5.2 The Telegraph equation",
    "text": "5.2 The Telegraph equation\nBy virtue of 5.2 we can cast the curl-curl equation 5.1 into the telegraph equation of induction, such that\n\\[\n-\\nabla^2 \\mathbf e + \\mu \\sigma \\partial_t \\mathbf e + \\mu \\varepsilon \\partial^2_{tt} \\mathbf e = \\mathbf 0.\n\\tag{5.4}\\]\n\n\n\n\n\n\nNote\n\n\n\nNote that the same PDE can be derived for the magnetic field!\n\n\nEq. 5.4 and 5.1 are second-order linear PDEs with at most second-order time derivatives. Hence, they describe wave phenomena.\n\n\n\n\n\n\nNote\n\n\n\nA second-order, linear, constant-coefficient PDE for \\(u\\) takes the general form\n\\[\nA u_{xx} + 2 B u_{xy} + C u_{yy} + D u_x + E u_y + F u + G = 0\n\\]\nThis PDE is classified as being\n\nparabolic, when \\(B^2 - AC = 0\\)\nhyperbolic, when \\(B^2 - AC &gt; 0\\)\nelliptic, when \\(B^2 - AC &lt; 0\\).\n\nIn our case, \\(x\\) plays the role of any spatial variable, and \\(t\\) plays the role of \\(y\\).\nHence, for 5.4, \\(A=-1\\), \\(E=\\mu\\sigma\\), \\(C=\\mu\\varepsilon\\), and the remaining coefficients are zero.\nChecks:\n\\(B^2 - AC = 0 - (-1 \\cdot \\mu\\varepsilon) &gt; 0\\) \\(\\to\\) PDE is hyperbolic.\n\\(B^2 - AC = 0 - (-1 \\cdot 0) = 0\\) \\(\\to\\) PDE is parabolic\nFor the elliptic PDE there are no time derivatives, we can therefore let \\(x\\) and \\(y\\) take their roles as Cartesian coordinates.\nSo, with \\(A = C = -1\\),\n\\(B^2 - AC = 0 - (-1 \\cdot -1) &lt; 0\\) \\(\\to\\) PDE is elliptic.",
    "crumbs": [
      "Maxwell's equations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Partial Differential Equations</span>"
    ]
  },
  {
    "objectID": "pde.html#quasi-static-approximation",
    "href": "pde.html#quasi-static-approximation",
    "title": "5  Partial Differential Equations",
    "section": "5.3 Quasi-static approximation",
    "text": "5.3 Quasi-static approximation\nIn geo-electromagnetic applications, the fields vary slowly with frequencies much less than 1 MHz. For Magnetotellurics, e.g., we use frequencies well below 100 Hz. In CSEM applications, frequencies rarely exceed 100 kHz.\nThe low frequency content of the electromagnetic field variations give reason to assume that the term associated with the second-order time derivative might be dropped.\nWe now want to provide a justification.\nThe terms in 5.1 have very different magnitudes depending on the scale of observation. To quantify the relative importance of the terms to each other, we cast the PDE into a dimensionless form.\nThis can be achieved by introducing scale lengths in space and time.\nWe introduce a typical scale length \\(L\\) and a typical period \\(T\\) and scale all spatial variables \\(\\ell\\) as well as the time \\(t\\).\nThe dimensionless variables are \\[\n\\ell' = \\ell / L \\qquad t' = t / T\n\\]\nWith the chain rule we obtain the dimensionless derivatives of a field component \\(f\\) \\[\n\\frac{\\partial f}{\\partial \\ell} = \\frac{\\partial f}{\\partial \\ell'} \\frac{\\partial \\ell'}{\\partial \\ell} = \\frac{1}{L} \\frac{\\partial f}{\\partial \\ell'}\n\\]\n\\[\n\\frac{\\partial f}{\\partial t} = \\frac{\\partial f}{\\partial t'} \\frac{\\partial t'}{\\partial t} = \\frac{1}{T} \\frac{\\partial f}{\\partial t'}\n\\]\nThis carries over to the differential operators, i.e., \\[\n\\nabla \\times \\nabla \\times \\mathbf f = \\frac{1}{L^2} \\nabla' \\times \\nabla' \\times \\mathbf f.\n\\]\nWe obtain a PDE with scaled coefficients, i.e., \\[\n\\nabla' \\times \\nabla' \\times \\mathbf e + \\eta_1 \\partial_{t'} \\mathbf e + \\eta_2 \\partial^{2}_{t't'} \\mathbf e = \\mathbf 0\n\\]\nThe coefficients are \\[\n\\begin{align}\n\\eta_1 &= \\frac{L^2}{T} \\mu \\sigma \\\\\n\\eta_2 &= \\frac{L^2}{T^2} \\mu\\varepsilon\n\\end{align}\n\\]\nWe assume that \\(\\mu=\\mu_0\\) and \\(\\varepsilon = \\varepsilon_0\\).\nThe exercise is now to show under which conditions there holds that \\(\\eta_1 \\gg \\eta_2\\).\nWhat is the physical interpretation of \\(\\eta_2\\)?\nWe see that \\[\n\\eta_2 = \\frac{L^2}{T^2} \\mu\\varepsilon = \\left( \\frac{L}{T c_0} \\right)^2.\n\\]\n\\(L/c_0\\) is the time an electromagnetic wave needs in free space to travel over the distance \\(L\\). If \\(\\eta_2\\) is small, this time is much less than a typical time \\(T\\) during which significant changes in the field occur. Such changes can be regarded as happening instantaneously over the region spanned by \\(L\\).\nUntil now, we have not considered the conductivities in that region. This can be studied with the ratio of both coefficients. We want to show that \\[\n\\frac{\\eta_1}{\\eta_2} = \\frac{\\mu\\sigma}{\\mu\\varepsilon} T = c_0^2 \\mu\\sigma T \\gg 1.\n\\]\nWe illustrate our findings and calculate meaningful values for the coefficients.\n\n\nShow the code\ndef eta1(T, L, sigma):\n  mu0 = np.pi * 4e-7\n  return L**2 / T * mu0 * sigma\n\ndef eta2(T, L):\n  mu0 = np.pi * 4e-7\n  epsilon0 = 8.854e-12\n  return L**2 / T**2 * mu0 * epsilon0\n\nT = np.logspace(-6, 3, num=91)\nL = 1e7\nplt.loglog(T, [eta2(t, L) for t in T])\nplt.xlabel('T in s')\nplt.ylabel(r'$\\eta_2$')\nplt.grid(True)\n\n\n\n\n\n\n\n\n\nIn global investigations for which \\(L \\approx 10^4\\) km, we observe that \\(\\eta_2\\) is small (less than, e.g., 0.1) for \\(T &gt; 0.1\\) seconds.\n\n\nShow the code\nplt.loglog(1 / T, [eta1(t, L, 1e-5) / eta2(t, L) for t in T])\nplt.xlabel('frequency in Hz')\nplt.ylabel(r'$\\eta_1 / \\eta_2$')\nplt.grid(True)\n\n\n\n\n\n\n\n\n\nIn the last example we have used a conductivity of \\(10^{-5}\\) S/m as a reasonable low value for minerals. We recognize that the ratio is large for frequencies less than \\(10^5\\) Hz.\nTo conclude, we can safely assume that the second term, \\(\\eta_2\\), and correspondingly the term \\(\\mu\\varepsilon\\), can be neglected for frequencies less than \\(10^5\\) Hz for the lowest reasonable value of the conductivity in the Earth. For higher conductivities, the result becomes even more pronounced.\nAs a consequence, the displacement current density in Ampere’s law can be neglected as well, such that \\[\n\\nabla \\times \\mathbf{h} = \\mathbf j\n\\]\nWe call this the quasi-static approximation of Maxwell’s equations.\nNote that this corresponds to the classical formulation of Maxwell’s equations, which have later been extended to account for displacement currents.\nThe quasi-static approximation however comes at a price: The coefficient of the second-order time derivative term of 5.1 has the physical dimension of the inverse square of the wave velocity, i.e., \\[\n\\mu\\varepsilon = \\frac{1}{c_0^2}.\n\\]\nWhen we neglect this term, we implicitly assume that \\[\n\\frac{1}{c_0^2} \\to 0,\n\\] which violates the generally recognized fact that the speed of light is finite. On the other hand, this makes it clear that changes in the fields happen everywhere at the same time.\nThe curl-curl equation for the electric field under quasi-static approximation reads \\[\n\\nabla \\times \\nabla \\times \\mathbf e + \\mu\\sigma \\partial_t \\mathbf e = \\mathbf 0\n\\tag{5.5}\\]\nWith the identity introduced earlier, we write\n\\[\n-\\nabla^2 \\mathbf e + \\mu\\sigma \\partial_t \\mathbf e = \\mathbf 0\n\\tag{5.6}\\]\nWith our definition of the Fourier transform given by 3.2 we transform the time-domain expressions into the frequency domain.\nBy doing so, we decouple the time-dependency from the PDE. For most CSEM applications, this is common practice.\nFor time-harmonic fields with an angular frequency of \\(\\omega = 2 \\pi f\\), we write \\[\n\\mathbf E(\\omega) = \\mathbf E_0 \\exp(i \\omega t)\n\\] and use the properties of the Fourier transform to equivalently formulate time derivatives. It holds that \\[\n\\partial_t \\mathbf E_0 \\exp(i \\omega t) = i \\omega \\mathbf E_0 \\exp(i \\omega t) = i \\omega \\mathbf E(\\omega).\n\\] In other words, we simply replace all first-order time-derivatives with \\(i\\omega\\), and all second-order time derivatives by \\(-\\omega^2\\).\n\n\n\n\n\n\nTime derivatives in the frequency domain\n\n\n\n\\[\n\\partial_t \\to i\\omega \\qquad \\partial^2_{tt} \\to -\\omega^2\n\\]",
    "crumbs": [
      "Maxwell's equations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Partial Differential Equations</span>"
    ]
  },
  {
    "objectID": "pde.html#the-vector-helmholtz-equation",
    "href": "pde.html#the-vector-helmholtz-equation",
    "title": "5  Partial Differential Equations",
    "section": "5.4 The Vector Helmholtz equation",
    "text": "5.4 The Vector Helmholtz equation\nWe use the identity 5.2 and obtain \\[\n-\\nabla^2 \\mathbf E + i \\omega \\mu \\sigma \\mathbf E = \\mathbf 0\n\\]\n\n\n\n\n\n\nNotation\n\n\n\nIn what follows, we use capital letters for fields in the frequency domain, e.g., \\(\\mathbf E\\).\nIn the time domain, the fields are typeset in small letters, e.g., \\(\\mathbf e\\).\n\n\nMany textbooks use the notation \\[\n\\nabla^2 \\mathbf e - i \\omega \\mu \\sigma \\mathbf e = \\mathbf 0\n\\] with the abbreviation \\[\n\\nabla^2 \\mathbf e + k^2 \\mathbf e = \\mathbf 0,\n\\tag{5.7}\\] where \\[\nk^2 = - i \\omega \\mu \\sigma.\n\\]\nEquation 5.7 is referred to as the homogeneous Helmholtz equation.\nThe coefficient \\(k\\) is often called the wave number or wave propagation constant.\n\n\n\n\n\n\nWarning\n\n\n\nNote that \\(k^2\\) is a complex-valued quantity. The roots of \\(k^2\\) must be chosen carefully.\n\n\n\n5.4.1 The roots of \\(k^2\\)\nWe consider a Helmholtz equation for a plane wave \\[\n\\mathbf H = [1, 0, 0]^\\top \\text{ in } z &lt; 0\n\\] with a time dependency of \\(\\exp(i \\omega t)\\). \\(\\mathbf H\\) is a magnetic field, which is uniform in any horizontal plane, and exhibits only a horizontal component.\nInside the conducting Earth, the magnetic field will be attenuated due to energy dissipation. This can be modelled using the Helmholtz equation.\nThe magnetic field in \\(z \\ge 0\\) is a solution of the scalar Helmholtz equation \\[\n\\partial^2_{zz} H_x + k^2 H_x = 0\n\\tag{5.8}\\] where \\[\nH_x(z) = H_x(0) e^{-i k z}.\n\\tag{5.9}\\] The propagation inside the Earth depends on \\(k^2\\). However, in 5.9 we need the root of \\(k^2\\).\nPhysical reasoning gives a hint on which of both signs of \\(\\pm k\\) has to be used.\nIn the following we choose the proper sign by numerical evidence.\nWe use sympy to exlore the problem:\n\n5.4.1.1 Symbolic representation of \\(k^2\\)\n\n\nShow the code\nimport sympy\nfrom IPython.display import display, Math \ninit_printing(use_latex='mathjax', latex_mode='equation')\n\nalpha, beta, z = symbols(r'\\alpha \\beta z', real=True)\nomega, sigma, mu = symbols(r'\\omega \\sigma \\mu', real=True, positive=True)\n\n\nWe make the ansatz \\[\nk^2 = (\\alpha - i \\beta)^2\n\\] Expansion and separation of real and imaginary parts yiels the two equations \\[\n\\alpha^2 - \\beta^2 = 0\n\\] and \\[\n-2 \\alpha \\beta = - \\omega \\mu \\sigma.\n\\]\n\n\nShow the code\nexpr = expand((alpha - I * beta)**2)\nre(expr)\n\n\n\\[\\begin{equation}\\alpha^{2} - \\beta^{2}\\end{equation}\\]\n\n\n\n\nShow the code\nk2 = -I * omega * mu * sigma\n\nex = re(expr).subs(beta, solve([im(expr) - im(k2)], beta)[beta])\n# solve([im(expr) - im(k2)], beta)[beta]\n\nsol = solve(ex, alpha)\nsol\n\n\n\\[\\begin{equation}\\left[ - \\frac{\\sqrt{2} \\sqrt{\\mu} \\sqrt{\\omega} \\sqrt{\\sigma}}{2}, \\  \\frac{\\sqrt{2} \\sqrt{\\mu} \\sqrt{\\omega} \\sqrt{\\sigma}}{2}\\right]\\end{equation}\\]\n\n\nWe see, that \\[\n\\alpha = \\pm \\sqrt{\\frac{\\omega \\mu \\sigma}{2}} = \\beta\n\\] It remains to decide on the correct sign of \\(\\alpha\\) and \\(\\beta\\).\nWe model the field component \\(H_x(z)\\) as a function of \\(\\alpha\\) and \\(\\beta\\). With \\(k = \\pm (\\alpha - i\\beta)\\) we get \\[\nH_x(z) = e^{-i k z} e^{+i \\omega t} = e^{-i \\alpha z} e^{-\\beta z} e^{+i \\omega t}.\n\\]\nOnly for \\(\\beta &gt; 0\\) we observe an exponential decay with depth to assure that \\(H_x(z) \\to 0\\) for \\(z \\to \\infty\\).\nWhen \\(\\beta = 0\\) (no damping), we observe a pure wave propagation.\nIn this case, \\[\nH_x(z) = e^{-i \\alpha z} e^{+i \\omega t} = e^{-i (\\alpha z - \\omega t)} = e^{-i \\varphi}\n\\]\nwith \\(\\varphi = \\alpha z - \\omega t\\) the phase of the wave.\nTo obtain the direction of wave propagation, we form the time dericative of the plane of constant phase, i.e., \\[\nz = \\frac{1}{\\alpha} (\\varphi + \\omega t)\n\\] and \\[\nc = \\dot{z} = \\frac{\\omega}{\\alpha}\n\\] The wave propagates in positive \\(z\\)-direction (with a positive wave velocity \\(c\\)) only when \\(\\alpha &gt; 0\\).\n\n\n\n\n\n\nNote\n\n\n\nSummary:\n\\[\n\\alpha = \\beta = \\sqrt{\\frac{\\omega \\mu \\sigma}{2}}\n\\]\n\n\n\n\n5.4.1.2 Skin depth\nIn the previous section we have seen that the electrical conductivity of the halfspace gives rise to an exponential decay of the wave amplitude.\nWe are now able to define a typical scale length which helps to understand the physical phenomena in different depths.\nRecall that \\(\\exp(-\\beta z) \\to 0\\) for \\(z \\to +\\infty\\) for \\(\\beta &gt; 0\\).\nThen there exists a depth \\(z = \\frac{1}{\\beta}\\) where the amplitude of the wave drops to \\(\\exp(-1)\\) of its surface amplitude.\nThis depth is called the electromagnetic skin depth \\(\\tau\\).\nAt this depth, the wave has lost 63 % of its surface amplitude.\n\\[\n\\tau = \\frac{1}{\\beta} = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}} \\approx 503 \\sqrt{\\rho / f}\n\\]\nThe last part of the equation approximates the skin depth. With \\(\\rho\\) given in \\(\\Omega \\cdot m\\) and \\(f\\) given in Hz, this equation returns the skin depth \\(\\tau\\) in meters.\nThe following animation shows the real and imaginary part of the magnetic field for a frequency of 1 Hz in a uniform halfspace with a resistivity of 100 \\(\\Omega \\cdot m\\). The red and green horizontal lines indicate the skin depth and the wave length, resp.\nCheck: For \\(\\rho = 100~\\Omega \\cdot m\\) and \\(f = 1\\) Hz, the skin depth is approximately \\[\n\\tau = 503 \\sqrt{\\rho / f} \\approx 5.03 \\text{ km.}\n\\]\n\\[\n\\lambda = 2 \\pi \\tau \\approx 31.6 \\text{ km.}\n\\]\n\n\n\n\n\n\nPython code\n\n\n\n\n\nThis is the Python code that you can use to create the following animation:\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom matplotlib.animation import FuncAnimation\n\ndef h(z, a, b, w, t):\n    return np.exp(-1j * a * z) * np.exp(-b * z) * np.exp(1j * w * t)\n\nT = 1.0\nw = 2 * np.pi / T \nsigma = 1e-2\nmu = np.pi * 4e-7\n\nkk = np.sqrt(w * mu * sigma / 2)\na = kk\nb = kk\nzair = np.arange(start=-10000, stop=0, step=100)\nzz = np.arange(start=0, stop=6e4, step=600)\ntau = 1.0 / kk\n\nfig, ax = plt.subplots(figsize=(4, 6), layout='constrained')\n\ndef update(frame):\n    ax.clear()\n    t = frame * T / 100.0\n    ax.plot([np.real(np.exp(1j * w * t)) for _ in zair], zair, color='blue', label='', zorder=1)\n    ax.plot([np.real(h(z, a, b, w, t)) for z in zz], zz, color='blue', label='Re', zorder=2)\n    ax.plot([np.imag(h(z, a, b, w, t)) for z in zz], zz, label='Im', zorder=3)\n    ax.fill_betweenx(zz, -np.exp(-b * zz), np.exp(-b * zz), color='grey', alpha=0.5, label='')\n    zp = w * t / a if a &gt; 0.0 else np.max(zz) + w * t / a\n    ax.scatter(np.real(h(zp, a, b, w, t)), zp, marker='*', color='black', label='phase')\n    ax.axhline(y=tau, color='red', label='τ')\n    ax.axhline(y=2 * np.pi * tau, color='green', label='λ')\n    ax.set_ylabel('Depth in km')\n    ax.set_xlabel('Normalized amplitude')\n    ax.set_xlim(-1.0, 1.0)\n    ax.set_ylim(min(zair), max(zz))\n    ax.invert_yaxis()\n    ax.legend(loc='lower left')\n\nani = FuncAnimation(fig, update, frames=100, interval=50)\n\nani.save('animation.gif')",
    "crumbs": [
      "Maxwell's equations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Partial Differential Equations</span>"
    ]
  },
  {
    "objectID": "mtfields.html",
    "href": "mtfields.html",
    "title": "6  Plane waves above and inside a homogeneous Earth",
    "section": "",
    "text": "6.1 Visualization\nWe illustrate our results with a simple example of a uniform halfspace with a conductivity of 0.01 S/m and a frequency of 10 Hz.\nShown are real (Re) and imaginary (Im) part of the fields along with their magnitude (Abs) as a function of depth.\nClearly visible is the exponential decay with depth.\nShow the code\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nf = 10\nomega = 2 * np.pi * f\nsigma = 0.01\n\nz = np.arange(-1000, 10001, 10)\n\ndef h(omega, sigma, z):\n    k = np.sqrt(-1j * omega * np.pi * 4e-7 * sigma)\n    if z &lt; 0:\n        H = 1 + 1j * 0\n    if z &gt;= 0:\n        H = np.exp(-1j * k * z)\n    return H\n\ndef e(omega, sigma, z):\n    k = np.sqrt(-1j * omega * np.pi * 4e-7 * sigma)\n    if z &lt; 0:\n        E = -1j * k / sigma * (1 - 1j * k * z)\n    if z &gt;= 0:\n        E = -1j * k / sigma * np.exp(-1j * k * z)\n    return E\n\nH = [h(omega, sigma, zz) for zz in z]\nE = [e(omega, sigma, zz) for zz in z]\nH0 = h(omega, sigma, 0.0)\nE0 = e(omega, sigma, 0.0)\nIn our example, the skin depth is 1590.63 m.\nShow the code\nfig, ax = plt.subplots(figsize=(4, 4), layout='constrained')\nax.plot(np.real(E / E0), z, label='Re')\nax.plot(np.imag(E / E0), z, label='Im')\nax.plot(np.abs(E / E0), z, label='Abs')\nax.axhspan(z[0], 0.0, facecolor='lightblue', alpha=0.4)\nax.axhspan(0.0, z[-1], facecolor='lightgreen', alpha=0.4)\nax.invert_yaxis()\nax.set_ylim((z[-1], z[0]))\nax.set_ylabel('depth in m')\nax.set_xlabel(r'$E(z)/E(0)$')\nax.set_title('Normalized electric field')\nax.grid(True)\nax.legend(loc='lower right')\nShow the code\nfig, ax = plt.subplots(figsize=(4, 4), layout='constrained')\nax.plot(np.real(H / H0), z, label='Re')\nax.plot(np.imag(H / H0), z, label='Im')\nax.plot(np.abs(H / H0), z, label='Abs')\nax.axhspan(z[0], 0.0, facecolor='lightblue', alpha=0.4)\nax.axhspan(0.0, z[-1], facecolor='lightgreen', alpha=0.4)\nax.invert_yaxis()\nax.set_ylim((z[-1], z[0]))\nax.set_ylabel('depth in m')\nax.set_xlabel(r'$H(z)/H(0)$')\nax.set_title('Normalized magnetic field')\nax.grid(True)\nax.legend(loc='lower right')",
    "crumbs": [
      "Maxwell's equations",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Plane waves above and inside a homogeneous Earth</span>"
    ]
  },
  {
    "objectID": "potentials.html",
    "href": "potentials.html",
    "title": "7  Sources in unbounded media",
    "section": "",
    "text": "7.1 Polarization vectors\nIn the absence of matter, we observe that \\[\n\\mathbf d - \\varepsilon_0 \\mathbf e = \\mathbf 0\n\\] and \\[\n\\mu_0^{-1} \\mathbf b - \\mathbf h = \\mathbf 0.\n\\] When the differences are non-zero, then we observe the response of matter. We define the electrical polarization \\(\\mathbf p\\) \\[\n\\mathbf p = \\mathbf d - \\varepsilon_0 \\mathbf e\n\\] and the magnetic polaization or magnetization \\(\\mathbf m\\) \\[\n\\mathbf m = \\mu_0^{-1} \\mathbf b - \\mathbf h\n\\] The polarization vectors \\(\\mathbf p\\) and \\(\\mathbf m\\) are parallel and proportional to \\(\\mathbf e\\) and \\(\\mathbf h\\), resp.\nWe are able to quantify the polarization properties by the electrical susceptibility \\(\\chi_e\\) and magnetic susceptibility \\(\\chi_m\\). The latter is often referred to as the magnetic susceptibility \\(\\kappa\\).\nWe define \\[\n\\mathbf p := \\chi_e \\varepsilon_0 \\mathbf e = \\mathbf d - \\varepsilon_0 \\mathbf e\n\\] and likewise \\[\n\\mathbf m := \\chi_m \\mathbf h = \\mu_0^{-1} \\mathbf b - \\mathbf h.\n\\] It follows for the relative dielectric permittivity \\[\n\\varepsilon_r = 1 + \\chi_e\n\\] and for the relative magnetic permeability \\[\n\\mu_r = 1 + \\chi_m = 1 + \\kappa.\n\\]\nTo implement technical sources, we separate the polarization into induced (superscript \\(i\\)) and external (superscript \\(s\\)) contributions to the observed fields: \\[\n\\mathbf p = \\mathbf p^i + \\mathbf p^s = \\mathbf d - \\varepsilon_0 \\mathbf e.\n\\] Then, \\[\n\\mathbf d = [\\underbrace{\\varepsilon_0 \\mathbf e}_\\text{free space} + \\underbrace{\\mathbf p^i}_\\text{matter}] + \\mathbf p^s\n\\] and \\[\n\\mathbf b = [\\underbrace{\\mu_0 \\mathbf h}_\\text{free space} + \\underbrace{\\mu_0 \\mathbf m^i}_\\text{matter}] + \\mu_0 \\mathbf m^s\n\\]\nWith the introduction of the polarization vectors, we are now able to augment Maxwell’s equations, such that \\[\n\\begin{align}\n\\nabla \\times \\mathbf h & = \\mathbf j + \\varepsilon \\partial_t \\mathbf e + \\partial_t \\mathbf p^s \\\\\n\\nabla \\times \\mathbf e & = \\phantom{\\mathbf j} -\\mu \\partial_t \\mathbf h - \\mu_0 \\partial_t \\mathbf m^s\n\\end{align}\n\\]\nWe define the source current densities in the magnetic and electric case as \\[\n\\mathbf j_m^s := \\mu_0 \\partial_t \\mathbf m^s\n\\] and \\[\n\\mathbf j_e^s := \\phantom{\\mu_0} \\partial_t \\mathbf p^s .\n\\]\nNow, we extend our definitions to the frequency domain: \\[\n\\mathbf J_m^s := i \\omega \\mu_0 \\mathbf M^s\n\\] and \\[\n\\mathbf J_e^s := i \\omega \\mathbf P^s .\n\\]",
    "crumbs": [
      "Dipole induction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Sources in unbounded media</span>"
    ]
  },
  {
    "objectID": "potentials.html#polarization-vectors",
    "href": "potentials.html#polarization-vectors",
    "title": "7  Sources in unbounded media",
    "section": "",
    "text": "Example\n\n\n\nWe consider a magnetic dipole at the point \\(\\mathbf r_0 = [0, 0, -h]^\\top, h &gt; 0\\).\nThe point of observation is at \\(\\mathbf r = [x, y, z]^\\top\\).\nThe loaction of the dipole can now be pinned to \\(\\mathbf r_0\\) using a Dirac delta function.\nWe obtain \\[\n\\mathbf M^s(\\mathbf r) = \\mathbf m \\, \\delta(\\mathbf r - \\mathbf r_0)\n\\] with \\(\\mathbf m\\) the oriented magnetic dipole moment. The dipole moment has the physical dimension of \\([\\mathbf m] =\\) A\\(\\cdot m^2\\). It can be interpreted as a current \\(I\\) measured in A enclosing a surface measured in \\(m^2\\).\nAs a vector quantity, the dipole moment has a direction. Its direction is given by the unit vector normal to the surface of the enclosed area.\nA useful special case arises when the dipole is aligned with one of the Cartesian axes.\nThis way, we can define a vertical or horizontal dipole.",
    "crumbs": [
      "Dipole induction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Sources in unbounded media</span>"
    ]
  },
  {
    "objectID": "potentials.html#electromagnetic-potentials",
    "href": "potentials.html#electromagnetic-potentials",
    "title": "7  Sources in unbounded media",
    "section": "7.2 Electromagnetic potentials",
    "text": "7.2 Electromagnetic potentials\nLet’s assume that electric and magnetic fields originate from either a magnetic or an electric source, i.e., \\[\n\\begin{align}\n\\mathbf E & = \\mathbf E_m + \\mathbf E_e \\\\\n\\mathbf H & = \\mathbf H_m + \\mathbf H_e\n\\end{align}\n\\] When \\(\\mathbf J_e \\equiv 0\\), then we only observe the set of fields \\([\\mathbf E_m, \\mathbf H_m]\\).\nWhen \\(\\mathbf J_m \\equiv 0\\), then we only observe the set of fields \\([\\mathbf E_e, \\mathbf H_e]\\).\nThe two sets are disjoint. We insert into Maxwell’s equations \\[\n\\begin{align}\n\\nabla \\times \\mathbf E_m & = -i \\omega \\mu \\mathbf H_m \\textcolor{red}{- \\mathbf J_m^s} \\\\\n\\nabla \\times \\mathbf H_m & = (\\sigma + i \\omega \\varepsilon) \\mathbf E_m\n\\end{align}\n\\]\n\\[\n\\begin{align}\n\\nabla \\times \\mathbf E_e & = -i \\omega \\mu \\mathbf H_e  \\\\\n\\nabla \\times \\mathbf H_e & = (\\sigma + i \\omega \\varepsilon) \\mathbf E_e \\textcolor{red}{+ \\mathbf J_e^s}\n\\end{align}\n\\]\nNow we apply the divergence to all of the above equations. Here we employ the identity \\[\n\\nabla \\cdot (\\nabla \\times \\mathbf F) = 0,\n\\tag{7.1}\\] such that, e.g., \\[\n\\underbrace{\\nabla \\cdot (\\nabla \\times \\mathbf E_m)}_{=0}  = -i \\omega \\mu \\nabla \\cdot \\mathbf H_m - \\nabla \\cdot \\mathbf J_m^s.\n\\] We obtain \\[\n\\begin{align}\n\\nabla \\cdot \\mathbf H_m & = -\\frac{ \\nabla \\cdot \\mathbf J_m^s }{i \\omega \\mu } \\\\\n\\nabla \\cdot \\mathbf E_e & = -\\frac{ \\nabla \\cdot \\mathbf J_e^s }{\\sigma + i \\omega \\varepsilon } \\\\\n\\nabla \\cdot \\mathbf H_e & = 0 \\\\\n\\nabla \\cdot \\mathbf E_m & = 0.\n\\end{align}\n\\] Since the divergence of \\(\\mathbf H_e\\) and \\(\\mathbf E_m\\) are zero, we can express both fields by the curl of an arbitrary vector field according to 7.1. However, this vector field must fulfill Maxwell’s equations. The following ansatz employing the vector potentials \\(\\mathbf F\\) and \\(\\mathbf A\\) meets this requirement: \\[\n\\begin{align}\n\\mathbf E_m & = -\\nabla \\times \\mathbf F \\\\\n\\mathbf H_e & = \\phantom{-} \\nabla \\times \\mathbf A.\n\\end{align}\n\\] It follows \\[\n\\begin{align}\n\\nabla \\times \\mathbf H_m & = -(\\sigma + i \\omega \\varepsilon) \\nabla \\times \\mathbf F \\\\\n\\nabla \\times \\mathbf E_e & = -i \\omega \\mu \\nabla \\times \\mathbf A\n\\end{align}\n\\] from which we obtain \\[\n\\begin{align}\n\\mathbf H_m & = -(\\sigma + i \\omega \\varepsilon) \\mathbf F - \\nabla V \\\\\n\\mathbf E_e & = -i \\omega \\mu \\mathbf A - \\nabla U\n\\end{align}\n\\] because of \\[\n\\nabla \\times \\nabla u = \\mathbf 0.\n\\] The scalar potentials \\(V\\) and \\(U\\) are referred to as magnetic and electrical scalar potential, resp.",
    "crumbs": [
      "Dipole induction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Sources in unbounded media</span>"
    ]
  },
  {
    "objectID": "potentials.html#the-curl-curl-equation-for-the-potentials",
    "href": "potentials.html#the-curl-curl-equation-for-the-potentials",
    "title": "7  Sources in unbounded media",
    "section": "7.3 The curl-curl equation for the potentials",
    "text": "7.3 The curl-curl equation for the potentials",
    "crumbs": [
      "Dipole induction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Sources in unbounded media</span>"
    ]
  },
  {
    "objectID": "potentials.html#the-lorenz-gauge-condition",
    "href": "potentials.html#the-lorenz-gauge-condition",
    "title": "7  Sources in unbounded media",
    "section": "7.4 The Lorenz gauge condition",
    "text": "7.4 The Lorenz gauge condition",
    "crumbs": [
      "Dipole induction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Sources in unbounded media</span>"
    ]
  },
  {
    "objectID": "potentials.html#the-vector-helmholtz-equations-for-the-potentials",
    "href": "potentials.html#the-vector-helmholtz-equations-for-the-potentials",
    "title": "7  Sources in unbounded media",
    "section": "7.5 The vector Helmholtz equations for the potentials",
    "text": "7.5 The vector Helmholtz equations for the potentials",
    "crumbs": [
      "Dipole induction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Sources in unbounded media</span>"
    ]
  },
  {
    "objectID": "potentials.html#the-greens-function",
    "href": "potentials.html#the-greens-function",
    "title": "7  Sources in unbounded media",
    "section": "7.6 The Green’s function",
    "text": "7.6 The Green’s function",
    "crumbs": [
      "Dipole induction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Sources in unbounded media</span>"
    ]
  },
  {
    "objectID": "potentials.html#the-fields-of-a-dipole-source-in-full-space",
    "href": "potentials.html#the-fields-of-a-dipole-source-in-full-space",
    "title": "7  Sources in unbounded media",
    "section": "7.7 The fields of a dipole source in full-space",
    "text": "7.7 The fields of a dipole source in full-space",
    "crumbs": [
      "Dipole induction",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Sources in unbounded media</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html",
    "href": "Differential_Operators_Sympy.html",
    "title": "8  Differential operators using sympy",
    "section": "",
    "text": "8.1 Gradient\n\\[\n\\nabla f\n\\]",
    "crumbs": [
      "Incomplete chapters",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html#divergence",
    "href": "Differential_Operators_Sympy.html#divergence",
    "title": "8  Differential operators using sympy",
    "section": "8.2 Divergence",
    "text": "8.2 Divergence\n\\[\n\\nabla \\cdot \\mathbf F\n\\]",
    "crumbs": [
      "Incomplete chapters",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html#curl",
    "href": "Differential_Operators_Sympy.html#curl",
    "title": "8  Differential operators using sympy",
    "section": "8.3 Curl",
    "text": "8.3 Curl\n\\[\n\\nabla \\times \\mathbf F\n\\]\n\n\nShow the code\ndef nabla(f, x, y, z):\n    return Matrix([f.diff(x), f.diff(y), f.diff(z)])\n\ndef nabla_v(f, x, y, z,  v):\n    return nabla(f, x, y, z).dot(v)\n\ndef gradient_op(f, *variables):\n    \"\"\"Return the vector gradient of a scalar function.\"\"\"\n    return Matrix([f.diff(v) for v in variables ])\n\ndef divergence_op(vec_F, *vars):\n    \"\"\"Return the scalar divergence of a vector field.\"\"\"\n    return sum( Matrix( [ vec_F[i].diff(v) for i,v in enumerate(vars)]) )\n\ndef curl_part(vec_F, u, v, *vars):\n    return vec_F[v].diff(vars[u]) - vec_F[u].diff(vars[v])\n    \ndef curl_op(vec_F, *vars):\n    \"\"\"Return the curl of a vector field.\"\"\"\n    return Matrix([curl_part(vec_F, u, v, *vars) for u, v in [(1,2), (2,0), (0,1)]])\n\n\n\n\nShow the code\nx, y, z = symbols('x y z', real=True)\n\n\nCompute the gradient of \\[\nf = \\frac{1}{r},\n\\] where \\(r = \\sqrt{x^2 + y^2 + z^2}\\).\n\n\nShow the code\nr = sqrt(x**2 + y**2 + z**2)\n\n\n\n\nShow the code\na, b, c = symbols('a b c', real=True)\nV = a * x + b * y + c * z\ngradient_op(V, x, y, z)\n\n\n\\(\\displaystyle \\left[\\begin{matrix}a\\\\b\\\\c\\end{matrix}\\right]\\)\n\n\n\n\nShow the code\ng = gradient_op(1 / r, x, y, z) #subs(sqrt(x**2 + y**2 + z**2), r)\n\n\n\n\nShow the code\ndivergence_op(g, x, y, z)\n\n\n\\(\\displaystyle \\frac{3 x^{2}}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{5}{2}}} + \\frac{3 y^{2}}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{5}{2}}} + \\frac{3 z^{2}}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{5}{2}}} - \\frac{3}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{3}{2}}}\\)\n\n\n\n\nShow the code\ncurl_op(g, x, y, z)\n\n\n\\(\\displaystyle \\left[\\begin{matrix}0\\\\0\\\\0\\end{matrix}\\right]\\)",
    "crumbs": [
      "Incomplete chapters",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html#curl-formula",
    "href": "Differential_Operators_Sympy.html#curl-formula",
    "title": "8  Differential operators using sympy",
    "section": "8.4 Curl formula",
    "text": "8.4 Curl formula\n\n\nShow the code\nP, Q, R = [Function(ch, real = True)(x, y, z) for ch in ['P', 'Q', 'R']]\nP, Q, R\n\n\n(P(x, y, z), Q(x, y, z), R(x, y, z))\n\n\n\n\nShow the code\ncurl_op(Matrix([P, Q, R]), x, y, z)\n\n\n\\(\\displaystyle \\left[\\begin{matrix}- \\frac{\\partial}{\\partial z} Q{\\left(x,y,z \\right)} + \\frac{\\partial}{\\partial y} R{\\left(x,y,z \\right)}\\\\\\frac{\\partial}{\\partial z} P{\\left(x,y,z \\right)} - \\frac{\\partial}{\\partial x} R{\\left(x,y,z \\right)}\\\\- \\frac{\\partial}{\\partial y} P{\\left(x,y,z \\right)} + \\frac{\\partial}{\\partial x} Q{\\left(x,y,z \\right)}\\end{matrix}\\right]\\)",
    "crumbs": [
      "Incomplete chapters",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "Differential_Operators_Sympy.html#divergence-formula",
    "href": "Differential_Operators_Sympy.html#divergence-formula",
    "title": "8  Differential operators using sympy",
    "section": "8.5 Divergence formula",
    "text": "8.5 Divergence formula\n\n\nShow the code\ndivergence_op(Matrix([P, Q, R]), x, y, z)\n\n\n\\(\\displaystyle \\frac{\\partial}{\\partial x} P{\\left(x,y,z \\right)} + \\frac{\\partial}{\\partial y} Q{\\left(x,y,z \\right)} + \\frac{\\partial}{\\partial z} R{\\left(x,y,z \\right)}\\)",
    "crumbs": [
      "Incomplete chapters",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Differential operators using _sympy_</span>"
    ]
  },
  {
    "objectID": "semisphere.html",
    "href": "semisphere.html",
    "title": "9  Potential of a point source in a semi-sphere embedded in a uniform halfspace",
    "section": "",
    "text": "9.1 Verification\nLet’s check that the potential and the current density are actually continuous at \\(r=a\\).\nWe first form the respective expressions for \\(r=a\\) and check if the results vanish.\nShow the code\nD = U1.subs(r,a) - U2.subs(r,a)\nD\n\n\n\\(\\displaystyle \\frac{I \\rho_{1}}{2 \\pi a} - \\frac{I \\rho_{2}}{2 \\pi a} + \\frac{I \\left(- \\rho_{1} + \\rho_{2}\\right)}{2 \\pi a}\\)\nShow the code\nD.simplify()\n\n\n\\(\\displaystyle 0\\)\nThis result can be obtained directly by using the expression ex1 for the continuity of the potential:\nShow the code\nex1.subs(r, a).subs(A, A_).subs(B, B_).simplify()\n\n\n\\(\\displaystyle 0\\)\nIn ex2 we have used the condition for continuity of the radial component of the current densities:\nShow the code\nex2.subs(r, a).subs(B, B_)\n\n\n\\(\\displaystyle 0\\)\nBoth results indicate that the conditions of continuity are fullfilled.",
    "crumbs": [
      "Incomplete chapters",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Potential of a point source in a semi-sphere embedded in a uniform halfspace</span>"
    ]
  },
  {
    "objectID": "semisphere.html#visualization-of-the-result",
    "href": "semisphere.html#visualization-of-the-result",
    "title": "9  Potential of a point source in a semi-sphere embedded in a uniform halfspace",
    "section": "9.2 Visualization of the result",
    "text": "9.2 Visualization of the result\n\n\nShow the code\nimport matplotlib.pyplot as plt\n\n\n\n\nShow the code\nrho1_n = 100.0\nrho2_n = 1000.0\na_n = 3.0\n\n\n\n\nShow the code\nU1_f = lambdify([rho1, rho2, r, a, I], U1)\nU2_f = lambdify([rho1, rho2, r, a, I], U2)\n\n\n\n\nShow the code\nR1 = np.arange(1.0, a_n + .01, 0.1)\nR2 = np.arange(a_n, 10.0, 0.1)\n\n\n\n\nShow the code\nplt.plot(R1, [U1_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R1])\nplt.plot(R2, [U2_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R2])\nplt.title(\"Electric Potential\")\nplt.xlabel(\"r\")\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\nShow the code\nE1_f = lambdify([rho1, rho2, r, a, I], -diff(U1, r))\nE2_f = lambdify([rho1, rho2, r, a, I], -diff(U2, r))\n\nj1_f = lambdify([rho1, rho2, r, a, I], -diff(U1, r) / rho1)\nj2_f = lambdify([rho1, rho2, r, a, I], -diff(U2, r) / rho2)\n\n\n\n\nShow the code\nplt.plot(R1, [j1_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R1])\nplt.plot(R2, [j2_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R2])\nplt.title(\"Current density\")\nplt.xlabel(\"r\")\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\nShow the code\nplt.plot(R1, [E1_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R1])\nplt.plot(R2, [E2_f(rho1_n, rho2_n, r, a_n, 1.0) for r in R2])\nplt.title(\"Electric Field\")\nplt.xlabel(\"r\")\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\nThe value of a a is {eval}a_n",
    "crumbs": [
      "Incomplete chapters",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Potential of a point source in a semi-sphere embedded in a uniform halfspace</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "10  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.",
    "crumbs": [
      "Summary",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Summary</span>"
    ]
  },
  {
    "objectID": "index.html#prerequisites",
    "href": "index.html#prerequisites",
    "title": "Theory of Electromagnetic Methods",
    "section": "Prerequisites",
    "text": "Prerequisites\nThis course material contains lots of Python code immersed in the sections.\nYou can always copy the code and run it in a suitable Python runtime environment.\nIt is recommended to the Python installer which comes with miniconda.\nFurther, you can develop own ideas and dive deeper into the course material when you create your own Jupyter notebooks. To this end, you can use any of\n\nVisual Studio Code\nJupyterlab\nQuarto\nmystMD.\n\nWorking with Jupter Notebooks in Visual Studio Code is very easy.",
    "crumbs": [
      "Remarks"
    ]
  },
  {
    "objectID": "index.html#prerequisites-1",
    "href": "index.html#prerequisites-1",
    "title": "Theory of Electromagnetic Methods",
    "section": "Prerequisites",
    "text": "Prerequisites\nThis course material contains lots of Python code immersed in the sections.\nYou can always copy the code and run it in a suitable Python runtime environment.\nIt is recommended to the Python installer which comes with miniconda.\nFurther, you can develop own ideas and dive deeper into the course material when you create your own Jupyter notebooks. To this end, you can use any of\n\nVisual Studio Code\nJupyterlab\nQuarto\nmystMD.\n\nWorking with Jupter Notebooks in Visual Studio Code is very easy.",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "index.html#background",
    "href": "index.html#background",
    "title": "Theory of Electromagnetic Methods",
    "section": "Background",
    "text": "Background\nThis lecture is aimed at Master’s students in the 2nd semester. It is advisable to know the basics of electromagnetic applications.\nFurthermore, successful completion of the course on Theoretical Physics - Electrodynamics - is a highly recommended prerequisite for this lecture.",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "index.html#code",
    "href": "index.html#code",
    "title": "Theory of Electromagnetic Methods",
    "section": "Code",
    "text": "Code\nThis course material contains lots of Python code immersed in the sections.\nYou can always copy the code and run it in a suitable Python runtime environment.\nIt is recommended to the Python installer which comes with miniconda.\nFurther, you can develop own ideas and dive deeper into the course material when you create your own Jupyter notebooks. To this end, you can use any of\n\nVisual Studio Code\nJupyterlab\nQuarto\nmystMD.\n\nWorking with Jupter Notebooks in Visual Studio Code is very easy.",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "index.html#recommended-reading",
    "href": "index.html#recommended-reading",
    "title": "Theory of Electromagnetic Methods",
    "section": "Recommended Reading",
    "text": "Recommended Reading\nWard & Hohmann (1988)\n\n\n\n\nWard, S.H. & Hohmann, G.W., 1988. Electromagnetic theory for geophysical applications. Electromagnetic methods in applied geophysics, Vol. 1, pp. 131–311.",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Ward, S.H. & Hohmann, G.W., 1988. Electromagnetic theory for\ngeophysical applications. Electromagnetic methods in applied\ngeophysics, Vol. 1, pp. 131–311.",
    "crumbs": [
      "References"
    ]
  }
]